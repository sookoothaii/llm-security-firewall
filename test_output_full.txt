============================= test session starts =============================
platform win32 -- Python 3.12.7, pytest-8.4.2, pluggy-1.6.0 -- D:\MCP Mods\HAK_GAL_HEXAGONAL\.venv_hexa\Scripts\python.exe
cachedir: .pytest_cache
rootdir: D:\MCP Mods\HAK_GAL_HEXAGONAL\standalone_packages\llm-security-firewall
configfile: pytest.ini
plugins: anyio-4.11.0
collecting ... collected 853 items

tests/gates/test_stream_guard.py::TestRollingWindowStreamGuard::test_guard_initialization PASSED [  0%]
tests/gates/test_stream_guard.py::TestRollingWindowStreamGuard::test_start_stream PASSED [  0%]
tests/gates/test_stream_guard.py::TestRollingWindowStreamGuard::test_safe_token_continues PASSED [  0%]
tests/gates/test_stream_guard.py::TestRollingWindowStreamGuard::test_high_risk_token_aborts PASSED [  0%]
tests/gates/test_stream_guard.py::TestRollingWindowStreamGuard::test_cumulative_risk_accumulates PASSED [  0%]
tests/judges/test_nli_consistency.py::TestNLIConsistencyJudge::test_judge_initialization PASSED [  0%]
tests/judges/test_nli_consistency.py::TestNLIConsistencyJudge::test_score_benign_text PASSED [  0%]
tests/judges/test_nli_consistency.py::TestNLIConsistencyJudge::test_detects_policy_bypass PASSED [  0%]
tests/judges/test_nli_consistency.py::TestNLIConsistencyJudge::test_detects_contradiction PASSED [  1%]
tests/judges/test_persuasion_fusion.py::TestPersuasionFusionJudge::test_judge_initialization PASSED [  1%]
tests/judges/test_persuasion_fusion.py::TestPersuasionFusionJudge::test_score_benign_text PASSED [  1%]
tests/judges/test_persuasion_fusion.py::TestPersuasionFusionJudge::test_score_persuasive_text PASSED [  1%]
tests/persuasion/test_ac_trie.py::test_ac_counts PASSED                  [  1%]
tests/persuasion/test_ac_trie.py::test_ac_case_insensitive PASSED        [  1%]
tests/persuasion/test_ac_trie.py::test_ac_no_false_positives PASSED      [  1%]
tests/persuasion/test_instructionality.py::test_step_markers PASSED      [  1%]
tests/persuasion/test_instructionality.py::test_no_steps PASSED          [  1%]
tests/persuasion/test_instructionality.py::test_requires_safety_wrap_true PASSED [  2%]
tests/persuasion/test_instructionality.py::test_requires_safety_wrap_false_with_guards PASSED [  2%]
tests/persuasion/test_instructionality.py::test_requires_safety_wrap_false_benign PASSED [  2%]
tests/persuasion/test_invariance_gate.py::test_divergence_blocks PASSED  [  2%]
tests/persuasion/test_invariance_gate.py::test_warn_on_persuasion PASSED [  2%]
tests/persuasion/test_invariance_gate.py::test_agreement_allows PASSED   [  2%]
tests/persuasion/test_l3_classifier.py::test_predict_shapes PASSED       [  2%]
tests/persuasion/test_l3_classifier.py::test_fallback_without_model PASSED [  2%]
tests/persuasion/test_l3_classifier.py::test_predict_labels PASSED       [  3%]
tests/persuasion/test_neutralizer.py::test_strip_and_restate_authority PASSED [  3%]
tests/persuasion/test_neutralizer.py::test_extract_intent_simple PASSED  [  3%]
tests/persuasion/test_neutralizer.py::test_pronoun_replacement PASSED    [  3%]
tests/persuasion/test_neutralizer.py::test_fallback_when_no_verb PASSED  [  3%]
tests/persuasion/test_persuasion_detector.py::test_basic_loading PASSED  [  3%]
tests/persuasion/test_persuasion_detector.py::test_detect_authority PASSED [  3%]
tests/persuasion/test_persuasion_detector.py::test_detect_roleplay PASSED [  3%]
tests/persuasion/test_persuasion_detector.py::test_low_score_benign PASSED [  3%]
tests/persuasion/test_persuasion_detector.py::test_detect_urgency PASSED [  4%]
tests/persuasion/test_persuasion_detector.py::test_detect_flattery PASSED [  4%]
tests/persuasion/test_persuasion_detector.py::test_detect_social_proof PASSED [  4%]
tests/persuasion/test_persuasion_detector.py::test_decide_function PASSED [  4%]
tests/persuasion/test_persuasion_detector.py::test_unicode_normalization PASSED [  4%]
tests/red_team/test_fake_citation_attack.py::TestFakeCitationAttack::test_fake_doi_rejected PASSED [  4%]
tests/red_team/test_fake_citation_attack.py::TestFakeCitationAttack::test_fake_arxiv_id_rejected PASSED [  4%]
tests/red_team/test_fake_citation_attack.py::TestFakeCitationAttack::test_authoritative_sounding_fake_source PASSED [  4%]
tests/red_team/test_fake_citation_attack.py::TestFakeCitationAttack::test_fake_citation_without_url PASSED [  5%]
tests/red_team/test_fake_citation_attack.py::TestFakeCitationAttack::test_mismatched_doi_and_content PASSED [  5%]
tests/red_team/test_goal_post_shift.py::TestGoalPostShift::test_immutable_criteria_enforcement PASSED [  5%]
tests/red_team/test_goal_post_shift.py::TestGoalPostShift::test_ex_ante_criteria_required PASSED [  5%]
tests/red_team/test_goal_post_shift.py::TestGoalPostShift::test_criteria_removal_detected PASSED [  5%]
tests/red_team/test_goal_post_shift.py::TestGoalPostShift::test_criteria_relaxation_detected PASSED [  5%]
tests/red_team/test_goal_post_shift.py::TestGoalPostShift::test_commit_hash_tamper_detection PASSED [  5%]
tests/red_team/test_memory_poisoning_attack.py::TestMemoryPoisoningAttack::test_minja_step1_direct_injection_blocked PASSED [  5%]
tests/red_team/test_memory_poisoning_attack.py::TestMemoryPoisoningAttack::test_minja_step3_retrieval_of_own_content_blocked PASSED [  5%]
tests/red_team/test_memory_poisoning_attack.py::TestMemoryPoisoningAttack::test_circular_reference_chain_detected PASSED [  6%]
tests/red_team/test_memory_poisoning_attack.py::TestMemoryPoisoningAttack::test_derived_from_own_analysis_blocked PASSED [  6%]
tests/red_team/test_memory_poisoning_attack.py::TestMemoryPoisoningAttack::test_excluded_flag_respected PASSED [  6%]
tests/red_team/test_memory_poisoning_attack.py::TestMemoryPoisoningAttack::test_legitimate_external_memory_accepted PASSED [  6%]
tests/red_team/test_retrieval_poisoning.py::TestRetrievalPoisoning::test_single_sided_sources_detected PASSED [  6%]
tests/red_team/test_retrieval_poisoning.py::TestRetrievalPoisoning::test_insufficient_corroboration_blocks_claim PASSED [  6%]
tests/red_team/test_retrieval_poisoning.py::TestRetrievalPoisoning::test_low_trust_sources_rejected_even_with_corroboration PASSED [  6%]
tests/red_team/test_retrieval_poisoning.py::TestRetrievalPoisoning::test_source_diversity_requirement PASSED [  6%]
tests/red_team/test_retrieval_poisoning.py::TestRetrievalPoisoning::test_high_trust_with_corroboration_passes PASSED [  7%]
tests/red_team/test_slow_roll_mimic.py::TestSlowRollMimic::test_gradual_shift_detection PASSED [  7%]
tests/red_team/test_slow_roll_mimic.py::TestSlowRollMimic::test_detection_within_3_sessions PASSED [  7%]
tests/red_team/test_slow_roll_mimic.py::TestSlowRollMimic::test_systematic_pattern_change_flagged PASSED [  7%]
tests/spatial/test_spatial_generator.py::TestSpatialCaptchaGenerator::test_generator_initialization PASSED [  7%]
tests/spatial/test_spatial_generator.py::TestSpatialCaptchaGenerator::test_generate_easy_challenge PASSED [  7%]
tests/spatial/test_spatial_generator.py::TestSpatialCaptchaGenerator::test_generate_medium_challenge PASSED [  7%]
tests/spatial/test_spatial_generator.py::TestSpatialCaptchaGenerator::test_generate_hard_challenge PASSED [  7%]
tests/spatial/test_spatial_generator.py::TestSpatialCaptchaGenerator::test_deterministic_generation PASSED [  7%]
tests/spatial/test_spatial_generator.py::TestSpatialCaptchaGenerator::test_verify_correct_answer PASSED [  8%]
tests/spatial/test_spatial_generator.py::TestSpatialCaptchaGenerator::test_verify_wrong_answer PASSED [  8%]
tests/spatial/test_spatial_generator.py::TestSpatialCaptchaGenerator::test_challenge_hash_deterministic PASSED [  8%]
tests/spatial/test_spatial_generator.py::TestSpatialCaptchaGenerator::test_different_seeds_different_challenges PASSED [  8%]
tests/spatial/test_spatial_generator.py::TestChallengeResponse::test_response_suspicious_too_fast PASSED [  8%]
tests/spatial/test_spatial_generator.py::TestChallengeResponse::test_response_suspicious_too_slow PASSED [  8%]
tests/spatial/test_spatial_generator.py::TestChallengeResponse::test_response_not_suspicious_normal_time PASSED [  8%]
tests/spatial/test_spatial_generator.py::TestUserSpatialProfile::test_profile_pass_rate PASSED [  8%]
tests/spatial/test_spatial_generator.py::TestUserSpatialProfile::test_recommend_difficulty_baseline PASSED [  9%]
tests/spatial/test_spatial_generator.py::TestUserSpatialProfile::test_recommend_difficulty_promote_to_hard PASSED [  9%]
tests/spatial/test_spatial_generator.py::TestUserSpatialProfile::test_recommend_difficulty_demote_to_easy PASSED [  9%]
tests/test_auto_strict_guard.py::test_auto_strict_triggers_on_threshold PASSED [  9%]
tests/test_auto_strict_guard.py::test_auto_strict_expires_after_duration PASSED [  9%]
tests/test_auto_strict_guard.py::test_auto_strict_prunes_old_alarms PASSED [  9%]
tests/test_auto_strict_guard.py::test_auto_strict_stats PASSED           [  9%]
tests/test_benchmarks_harness.py::TestASRFPRMeasurement::test_asr_calculation PASSED [  9%]
tests/test_benchmarks_harness.py::TestASRFPRMeasurement::test_fpr_calculation PASSED [  9%]
tests/test_benchmarks_harness.py::TestASRFPRMeasurement::test_partial_detection PASSED [ 10%]
tests/test_benchmarks_harness.py::TestLatencyMeasurement::test_latency_returns_positive PASSED [ 10%]
tests/test_benchmarks_harness.py::TestLatencyMeasurement::test_latency_with_empty_samples PASSED [ 10%]
tests/test_benchmarks_harness.py::TestCriticalLeakMeasurement::test_leak_detection PASSED [ 10%]
tests/test_benchmarks_harness.py::TestCriticalLeakMeasurement::test_no_leaks PASSED [ 10%]
tests/test_benchmarks_harness.py::TestCriticalLeakMeasurement::test_all_leaks PASSED [ 10%]
tests/test_bidi_locale.py::test_bidi_controls_flag PASSED                [ 10%]
tests/test_bidi_locale.py::test_bidi_rlo_wrap PASSED                     [ 10%]
tests/test_bidi_locale.py::test_locale_labels_arabic PASSED              [ 11%]
tests/test_bidi_locale.py::test_locale_labels_hindi PASSED               [ 11%]
tests/test_bidi_locale.py::test_locale_labels_chinese PASSED             [ 11%]
tests/test_bidi_locale.py::test_detect_bidi_locale_combined PASSED       [ 11%]
tests/test_bidi_locale.py::test_no_false_positive PASSED                 [ 11%]
tests/test_bidi_proximity.py::test_bidi_near_provider_prefix PASSED      [ 11%]
tests/test_bidi_proximity.py::test_bidi_far_from_anchor_no_uplift PASSED [ 11%]
tests/test_bidi_proximity.py::test_no_bidi_no_uplift PASSED              [ 11%]
tests/test_canonicalization.py::test_cyrillic_homoglyphs PASSED          [ 11%]
tests/test_canonicalization.py::test_greek_homoglyphs PASSED             [ 12%]
tests/test_canonicalization.py::test_zero_width_chars PASSED             [ 12%]
tests/test_canonicalization.py::test_variation_selectors PASSED          [ 12%]
tests/test_canonicalization.py::test_whitespace_normalization PASSED     [ 12%]
tests/test_canonicalization.py::test_nfkc_normalization PASSED           [ 12%]
tests/test_canonicalization.py::test_idempotence PASSED                  [ 12%]
tests/test_canonicalization.py::test_benign_text PASSED                  [ 12%]
tests/test_canonicalization.py::test_combined_evasion PASSED             [ 12%]
tests/test_canonicalizer_required.py::test_homoglyph_WITHOUT_canonicalizer XFAIL [ 13%]
tests/test_canonicalizer_required.py::test_zero_width_WITH_canonicalizer PASSED [ 13%]
tests/test_canonicalizer_required.py::test_normal_text_WITH_canonicalizer PASSED [ 13%]
tests/test_canonicalizer_required.py::test_homoglyph_WITH_canonicalizer PASSED [ 13%]
tests/test_claim_graph.py::TestClaimGraphBasics::test_add_claim PASSED   [ 13%]
tests/test_claim_graph.py::TestClaimGraphBasics::test_add_source PASSED  [ 13%]
tests/test_claim_graph.py::TestClaimGraphBasics::test_add_claim_support PASSED [ 13%]
tests/test_claim_graph.py::TestClaimGraphBasics::test_add_citation PASSED [ 13%]
tests/test_claim_graph.py::TestClaimGraphValidation::test_support_without_claim_raises PASSED [ 13%]
tests/test_claim_graph.py::TestClaimGraphValidation::test_support_without_source_raises PASSED [ 14%]
tests/test_claim_graph.py::TestClaimGraphValidation::test_invalid_trust_raises PASSED [ 14%]
tests/test_claim_graph.py::TestClaimGraphValidation::test_invalid_recency_raises PASSED [ 14%]
tests/test_claim_graph.py::TestCycleDetection::test_no_cycle_linear_chain PASSED [ 14%]
tests/test_claim_graph.py::TestCycleDetection::test_detects_simple_cycle PASSED [ 14%]
tests/test_claim_graph.py::TestCycleDetection::test_detects_three_node_cycle PASSED [ 14%]
tests/test_claim_graph.py::TestCycleDetection::test_cycle_not_reachable_from_claim PASSED [ 14%]
tests/test_claim_graph.py::TestAggregatedSupport::test_single_source_support PASSED [ 14%]
tests/test_claim_graph.py::TestAggregatedSupport::test_multiple_sources_support PASSED [ 15%]
tests/test_claim_graph.py::TestAggregatedSupport::test_no_sources_zero_support PASSED [ 15%]
tests/test_claim_graph.py::TestPromotionReady::test_promotion_blocked_by_cycle PASSED [ 15%]
tests/test_claim_graph.py::TestPromotionReady::test_promotion_blocked_by_low_support PASSED [ 15%]
tests/test_claim_graph.py::TestPromotionReady::test_promotion_ready_when_valid PASSED [ 15%]
tests/test_claim_graph.py::TestStatistics::test_statistics_empty_graph PASSED [ 15%]
tests/test_claim_graph.py::TestStatistics::test_statistics_with_data PASSED [ 15%]
tests/test_conformal_online.py::test_threshold_fallbacks_and_decay PASSED [ 15%]
tests/test_conformal_online.py::test_pvalue_and_reject PASSED            [ 15%]
tests/test_conformal_online.py::test_bulk_update PASSED                  [ 16%]
tests/test_content_hasher.py::TestContentHasher::test_blake3_normalization_stable PASSED [ 16%]
tests/test_content_hasher.py::TestContentHasher::test_normalize_text_whitespace PASSED [ 16%]
tests/test_content_hasher.py::TestContentHasher::test_normalize_text_unicode PASSED [ 16%]
tests/test_content_hasher.py::TestContentHasher::test_blake3_hex_length PASSED [ 16%]
tests/test_content_hasher.py::TestContentHasher::test_blake3_hex_deterministic PASSED [ 16%]
tests/test_content_hasher.py::TestContentHasher::test_blake3_hex_different_inputs PASSED [ 16%]
tests/test_content_hasher.py::TestContentHasher::test_blake3_bytes PASSED [ 16%]
tests/test_content_hasher.py::TestContentHasher::test_empty_string_hashing PASSED [ 16%]
tests/test_context_whitelist.py::test_uuid_benign_context_allowed PASSED [ 17%]
tests/test_context_whitelist.py::test_git_hash_benign_context_allowed PASSED [ 17%]
tests/test_context_whitelist.py::test_sha256_benign_context_allowed PASSED [ 17%]
tests/test_context_whitelist.py::test_no_benign_context_blocks PASSED    [ 17%]
tests/test_context_whitelist.py::test_suspicious_context_overrides PASSED [ 17%]
tests/test_data_generator.py::test_generator_runs PASSED                 [ 17%]
tests/test_data_generator.py::test_class_balance PASSED                  [ 17%]
tests/test_data_generator.py::test_no_harmful_content PASSED             [ 17%]
tests/test_dempster_shafer_fusion.py::TestEvidenceMass::test_valid_mass PASSED [ 18%]
tests/test_dempster_shafer_fusion.py::TestEvidenceMass::test_invalid_mass_sum PASSED [ 18%]
tests/test_dempster_shafer_fusion.py::TestEvidenceMass::test_invalid_mass_range PASSED [ 18%]
tests/test_dempster_shafer_fusion.py::TestDempsterShaferFusion::test_combine_single_mass PASSED [ 18%]
tests/test_dempster_shafer_fusion.py::TestDempsterShaferFusion::test_combine_empty_list PASSED [ 18%]
tests/test_dempster_shafer_fusion.py::TestDempsterShaferFusion::test_combine_consistent_masses PASSED [ 18%]
tests/test_dempster_shafer_fusion.py::TestDempsterShaferFusion::test_combine_conflicting_masses PASSED [ 18%]
tests/test_dempster_shafer_fusion.py::TestDempsterShaferFusion::test_should_promote_high_confidence PASSED [ 18%]
tests/test_dempster_shafer_fusion.py::TestDempsterShaferFusion::test_should_promote_low_confidence PASSED [ 18%]
tests/test_dempster_shafer_fusion.py::TestDempsterShaferFusion::test_detect_conflict_high PASSED [ 19%]
tests/test_dempster_shafer_fusion.py::TestDempsterShaferFusion::test_detect_conflict_low PASSED [ 19%]
tests/test_dempster_shafer_fusion.py::TestCreateEvidenceMasses::test_create_masses_basic PASSED [ 19%]
tests/test_dempster_shafer_fusion.py::TestCreateEvidenceMasses::test_create_masses_zero_weights PASSED [ 19%]
tests/test_dempster_shafer_fusion.py::TestIntegration::test_pipeline_simulation PASSED [ 19%]
tests/test_domain_trust_scorer.py::TestDomainTrustScorer::test_tier_1_authoritative PASSED [ 19%]
tests/test_domain_trust_scorer.py::TestDomainTrustScorer::test_tier_2_academic_government PASSED [ 19%]
tests/test_domain_trust_scorer.py::TestDomainTrustScorer::test_tier_4_wikipedia PASSED [ 19%]
tests/test_domain_trust_scorer.py::TestDomainTrustScorer::test_tier_5_social_media PASSED [ 20%]
tests/test_domain_trust_scorer.py::TestDomainTrustScorer::test_denylisted_domains PASSED [ 20%]
tests/test_domain_trust_scorer.py::TestDomainTrustScorer::test_unknown_domain_low_trust PASSED [ 20%]
tests/test_domain_trust_scorer.py::TestDomainTrustScorer::test_signature_bonus PASSED [ 20%]
tests/test_domain_trust_scorer.py::TestDomainTrustScorer::test_www_prefix_handling PASSED [ 20%]
tests/test_domain_trust_scorer.py::TestDomainTrustScorer::test_batch_scoring PASSED [ 20%]
tests/test_domain_trust_scorer.py::TestDomainTrustScorer::test_get_tier_classification PASSED [ 20%]
tests/test_domain_trust_scorer.py::TestDomainTrustScorer::test_statistics PASSED [ 20%]
tests/test_e_value_session_risk.py::test_evalue_grows_with_hits PASSED   [ 20%]
tests/test_e_value_session_risk.py::test_evalue_supermartingale_under_null PASSED [ 21%]
tests/test_e_value_session_risk.py::test_crossed_alarm_triggers PASSED   [ 21%]
tests/test_e_value_session_risk.py::test_risk_score_mapping PASSED       [ 21%]
tests/test_e_value_session_risk.py::test_slow_roll_detection PASSED      [ 21%]
tests/test_encoding_base85.py::test_shannon_entropy PASSED               [ 21%]
tests/test_encoding_base85.py::test_ascii85_delimited_detects PASSED     [ 21%]
tests/test_encoding_base85.py::test_z85_long_run_detects PASSED          [ 21%]
tests/test_encoding_base85.py::test_composition_triple_threat PASSED     [ 21%]
tests/test_encoding_base85.py::test_no_false_positive_on_clean PASSED    [ 22%]
tests/test_encoding_base85.py::test_is_probably_base85 PASSED            [ 22%]
tests/test_encoding_controls.py::test_base64_negative_control_benign PASSED [ 22%]
tests/test_encoding_controls.py::test_hex_negative_control_benign PASSED [ 22%]
tests/test_encoding_controls.py::test_base64_with_jailbreak_context PASSED [ 22%]
tests/test_evidence_pipeline.py::TestEvidencePipeline::test_pipeline_promotes_when_all_thresholds_pass PASSED [ 22%]
tests/test_evidence_pipeline.py::TestEvidencePipeline::test_pipeline_quarantines_low_trust PASSED [ 22%]
tests/test_evidence_pipeline.py::TestEvidencePipeline::test_pipeline_quarantines_low_nli PASSED [ 22%]
tests/test_evidence_pipeline.py::TestEvidencePipeline::test_pipeline_quarantines_insufficient_corroboration PASSED [ 22%]
tests/test_evidence_pipeline.py::TestEvidencePipeline::test_pipeline_rejects_self_authored PASSED [ 23%]
tests/test_evidence_validator.py::TestEvidenceValidator::test_self_authored_evidence_rejected PASSED [ 23%]
tests/test_evidence_validator.py::TestEvidenceValidator::test_creator_instance_id_rejected PASSED [ 23%]
tests/test_evidence_validator.py::TestEvidenceValidator::test_supermemory_self_created_rejected PASSED [ 23%]
tests/test_evidence_validator.py::TestEvidenceValidator::test_supermemory_excluded_from_evidence_rejected PASSED [ 23%]
tests/test_evidence_validator.py::TestEvidenceValidator::test_kb_self_authored_rejected PASSED [ 23%]
tests/test_evidence_validator.py::TestEvidenceValidator::test_circular_reference_rejected PASSED [ 23%]
tests/test_evidence_validator.py::TestEvidenceValidator::test_derived_from_instance_rejected PASSED [ 23%]
tests/test_evidence_validator.py::TestEvidenceValidator::test_valid_external_evidence_accepted PASSED [ 24%]
tests/test_evidence_validator.py::TestEvidenceValidator::test_valid_supermemory_from_other_instance_accepted PASSED [ 24%]
tests/test_evidence_validator.py::TestEvidenceValidator::test_batch_validation PASSED [ 24%]
tests/test_evidence_validator.py::TestEvidenceValidator::test_statistics_tracking PASSED [ 24%]
tests/test_evidence_validator.py::TestEvidenceValidator::test_missing_source_rejected PASSED [ 24%]
tests/test_explain_why.py::TestEvidenceItem::test_evidence_item_creation PASSED [ 24%]
tests/test_explain_why.py::TestExplainWhyEngine::test_create_reasoning_promote PASSED [ 24%]
tests/test_explain_why.py::TestExplainWhyEngine::test_create_reasoning_quarantine PASSED [ 24%]
tests/test_explain_why.py::TestExplainWhyEngine::test_reasoning_to_json PASSED [ 24%]
tests/test_explain_why.py::TestExplainWhyEngine::test_reasoning_to_audit_log PASSED [ 25%]
tests/test_explain_why.py::TestExplainWhyEngine::test_validate_reasoning_valid PASSED [ 25%]
tests/test_explain_why.py::TestExplainWhyEngine::test_get_reasoning_by_id PASSED [ 25%]
tests/test_explain_why.py::TestExplainWhyEngine::test_get_recent_reasoning PASSED [ 25%]
tests/test_explain_why.py::TestExplainWhyEngine::test_export_for_regression PASSED [ 25%]
tests/test_explain_why.py::TestExplainWhyEngine::test_get_statistics PASSED [ 25%]
tests/test_explain_why.py::TestIntegration::test_full_reasoning_pipeline PASSED [ 25%]
tests/test_explanation_formatter.py::TestExplanationFormatter::test_high_directness_abstention PASSED [ 25%]
tests/test_explanation_formatter.py::TestExplanationFormatter::test_moderate_directness_abstention PASSED [ 26%]
tests/test_explanation_formatter.py::TestExplanationFormatter::test_low_directness_abstention PASSED [ 26%]
tests/test_explanation_formatter.py::TestExplanationFormatter::test_precision_priority_affects_numbers PASSED [ 26%]
tests/test_explanation_formatter.py::TestExplanationFormatter::test_detail_level_affects_length PASSED [ 26%]
tests/test_explanation_formatter.py::TestExplanationFormatter::test_joerg_convenience_function PASSED [ 26%]
tests/test_feature_extractor.py::test_dimensions_and_bounds PASSED       [ 26%]
tests/test_feature_extractor.py::test_obfuscation_and_secrets_signals PASSED [ 26%]
tests/test_feature_extractor.py::test_empty_input PASSED                 [ 26%]
tests/test_feature_extractor.py::test_jailbreak_keywords PASSED          [ 26%]
tests/test_feature_extractor.py::test_cheap_scores_integration PASSED    [ 27%]
tests/test_feature_extractor.py::test_meta_info PASSED                   [ 27%]
tests/test_gapped_regex.py::test_gapped_regex_generation PASSED          [ 27%]
tests/test_gapped_regex.py::test_intent_gapped_positive PASSED           [ 27%]
tests/test_gapped_regex.py::test_intent_gapped_negative PASSED           [ 27%]
tests/test_gapped_regex.py::test_unicode_evasion PASSED                  [ 27%]
tests/test_gapped_regex.py::test_markdown_injection PASSED               [ 27%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_001] PASSED    [ 27%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_002] PASSED    [ 28%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_003] PASSED    [ 28%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_004] PASSED    [ 28%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_005] PASSED    [ 28%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_006] PASSED    [ 28%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_007] PASSED    [ 28%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_008] PASSED    [ 28%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_009] PASSED    [ 28%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_010] PASSED    [ 28%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_011] PASSED    [ 29%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_012] PASSED    [ 29%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_013] PASSED    [ 29%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_014] PASSED    [ 29%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_015] PASSED    [ 29%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_016] PASSED    [ 29%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_017] PASSED    [ 29%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_018] PASSED    [ 29%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_019] PASSED    [ 30%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_020] PASSED    [ 30%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_021] PASSED    [ 30%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_022] PASSED    [ 30%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_023] PASSED    [ 30%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_024] PASSED    [ 30%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_025] PASSED    [ 30%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_026] PASSED    [ 30%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_027] PASSED    [ 30%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_028] PASSED    [ 31%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_029] PASSED    [ 31%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_030] PASSED    [ 31%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_031] PASSED    [ 31%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_032] PASSED    [ 31%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_033] PASSED    [ 31%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_034] PASSED    [ 31%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_035] PASSED    [ 31%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_036] PASSED    [ 32%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_037] PASSED    [ 32%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_038] PASSED    [ 32%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_039] PASSED    [ 32%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_040] PASSED    [ 32%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_041] PASSED    [ 32%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_042] PASSED    [ 32%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_043] PASSED    [ 32%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_044] PASSED    [ 32%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_045] PASSED    [ 33%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_046] PASSED    [ 33%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_047] PASSED    [ 33%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_048] PASSED    [ 33%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_049] PASSED    [ 33%]
tests/test_gpt5_adversarial.py::test_adversarial_case[adv_050] PASSED    [ 33%]
tests/test_gpt5_adversarial.py::test_adversarial_summary_stats PASSED    [ 33%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[EC-01] PASSED [ 33%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[EC-02] PASSED [ 33%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[EC-03] PASSED [ 34%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[EC-04] PASSED [ 34%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[EC-05] PASSED [ 34%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[EC-06] PASSED [ 34%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[EC-07] PASSED [ 34%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[EC-08] PASSED [ 34%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[EC-09] PASSED [ 34%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[EC-10] PASSED [ 34%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[UN-01] PASSED [ 35%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[UN-02] PASSED [ 35%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[UN-03] PASSED [ 35%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[UN-04] PASSED [ 35%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[UN-05] PASSED [ 35%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[UN-06] PASSED [ 35%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[UN-07] PASSED [ 35%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[UN-08] PASSED [ 35%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[AR-01] PASSED [ 35%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[AR-02] PASSED [ 36%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[AR-03] PASSED [ 36%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[AR-04] PASSED [ 36%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[AR-05] PASSED [ 36%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[AR-06] PASSED [ 36%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[GR-01] PASSED [ 36%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[GR-02] PASSED [ 36%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[GR-03] PASSED [ 36%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[GR-04] PASSED [ 37%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[GR-05] PASSED [ 37%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[GR-06] PASSED [ 37%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[SE-01] PASSED [ 37%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[SE-02] PASSED [ 37%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[SE-03] PASSED [ 37%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[SE-04] PASSED [ 37%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[SE-05] PASSED [ 37%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[SM-01] PASSED [ 37%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[SM-02] PASSED [ 38%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[SM-03] PASSED [ 38%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[SM-04] PASSED [ 38%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[SM-05] PASSED [ 38%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[TH-01] PASSED [ 38%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[TH-02] PASSED [ 38%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[TH-03] PASSED [ 38%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[TH-04] PASSED [ 38%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[TH-05] PASSED [ 39%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[RF-01] PASSED [ 39%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[RF-02] PASSED [ 39%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_curated_exploits[RF-03] PASSED [ 39%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_encodings[E-b-6] PASSED [ 39%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_encodings[E-b-7_0] PASSED [ 39%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_encodings[E-b-7_1] PASSED [ 39%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_encodings[E-b-7_2] PASSED [ 39%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_encodings[U-z-A0] PASSED [ 39%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_encodings[U-z-A1] PASSED [ 40%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_encodings[U-z-A2] PASSED [ 40%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_encodings[Q-q-=0] PASSED [ 40%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_encodings[Q-q-=1] PASSED [ 40%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_encodings[Q-q-=2] PASSED [ 40%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_struct[B-b-c0] PASSED [ 40%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_struct[B-b-c1] PASSED [ 40%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_struct[B-b-c2] PASSED [ 40%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_struct[B-b-c3] PASSED [ 41%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_struct[D-d-d0] PASSED [ 41%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_struct[D-d-d1] PASSED [ 41%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_struct[D-d-d2] PASSED [ 41%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_struct[D-d-d3] PASSED [ 41%]
tests/test_gpt5_hardcore_redteam.py::test_gpt5_family_struct[D-d-d4] PASSED [ 41%]
tests/test_grammar_mutators.py::TestIndividualMutators::test_roleplay_mutator PASSED [ 41%]
tests/test_grammar_mutators.py::TestIndividualMutators::test_base64_mutator PASSED [ 41%]
tests/test_grammar_mutators.py::TestIndividualMutators::test_leet_mutator PASSED [ 41%]
tests/test_grammar_mutators.py::TestIndividualMutators::test_homoglyph_mutator PASSED [ 42%]
tests/test_grammar_mutators.py::TestIndividualMutators::test_punct_burst_mutator PASSED [ 42%]
tests/test_grammar_mutators.py::TestMutationChaining::test_mutate_single PASSED [ 42%]
tests/test_grammar_mutators.py::TestMutationChaining::test_mutate_chain PASSED [ 42%]
tests/test_grammar_mutators.py::TestMutationChaining::test_mutate_unknown_skipped PASSED [ 42%]
tests/test_grammar_mutators.py::TestRiskFeatureCoverage::test_coverage_obfuscations PASSED [ 42%]
tests/test_grammar_mutators.py::TestRiskFeatureCoverage::test_coverage_social_engineering PASSED [ 42%]
tests/test_grammar_mutators.py::TestRiskFeatureCoverage::test_coverage_multiple_categories PASSED [ 42%]
tests/test_grammar_mutators.py::TestRiskFeatureCoverage::test_coverage_empty PASSED [ 43%]
tests/test_grammar_mutators.py::TestRandomMutationPlan::test_random_plan_deterministic PASSED [ 43%]
tests/test_grammar_mutators.py::TestRandomMutationPlan::test_random_plan_length PASSED [ 43%]
tests/test_grammar_mutators.py::TestRandomMutationPlan::test_random_plan_valid_mutators PASSED [ 43%]
tests/test_ground_truth_scorer.py::TestGroundTruthScorer::test_kb_coverage_zero_facts PASSED [ 43%]
tests/test_ground_truth_scorer.py::TestGroundTruthScorer::test_kb_coverage_saturation PASSED [ 43%]
tests/test_ground_truth_scorer.py::TestGroundTruthScorer::test_source_quality_verified PASSED [ 43%]
tests/test_ground_truth_scorer.py::TestGroundTruthScorer::test_domain_half_life_math PASSED [ 43%]
tests/test_ground_truth_scorer.py::TestGroundTruthScorer::test_domain_half_life_news PASSED [ 43%]
tests/test_ground_truth_scorer.py::TestGroundTruthScorer::test_domain_specific_weights_math PASSED [ 44%]
tests/test_ground_truth_scorer.py::TestGroundTruthScorer::test_overall_score_computation PASSED [ 44%]
tests/test_ground_truth_scorer.py::TestGroundTruthScorer::test_domain_detection PASSED [ 44%]
tests/test_ground_truth_scorer.py::TestGroundTruthScorer::test_authority_domain_bonus PASSED [ 44%]
tests/test_guardnet_exporter.py::test_metrics_no_raise PASSED            [ 44%]
tests/test_guardnet_exporter.py::test_metrics_low_coverage_detection PASSED [ 44%]
tests/test_guardnet_shapes.py::test_feature_mlp_shape PASSED             [ 44%]
tests/test_guardnet_shapes.py::test_firewallnet_forward_shapes PASSED    [ 44%]
tests/test_guardnet_shapes.py::test_firewallnet_forward_different_seq_len PASSED [ 45%]
tests/test_guardnet_shapes.py::test_firewallnet_gradient_flow PASSED     [ 45%]
tests/test_hardcore_otb_bypass.py::test_msg_stable_malicious FAILED      [ 45%]
tests/test_hardcore_otb_bypass.py::test_k_of_n_single_family_overload FAILED [ 45%]
tests/test_hardcore_otb_bypass.py::test_executability_bypass_valid_code_hidden FAILED [ 45%]
tests/test_hardcore_otb_bypass.py::test_co_occurrence_bypass_entropy_alone FAILED [ 45%]
tests/test_hardcore_otb_bypass.py::test_indicator_gate_bypass_code_single FAILED [ 45%]
tests/test_hardcore_otb_bypass.py::test_bmv_near_miss_attack FAILED      [ 45%]
tests/test_hardcore_otb_bypass.py::test_multi_gate_bypass_combo FAILED   [ 45%]
tests/test_hardcore_otb_bypass.py::test_msg_metamorphic_evasion FAILED   [ 46%]
tests/test_hardcore_otb_bypass.py::test_zero_family_stealth FAILED       [ 46%]
tests/test_hardcore_otb_bypass.py::test_context_confusion_attack FAILED  [ 46%]
tests/test_hardcore_otb_bypass.py::test_threshold_hunting FAILED         [ 46%]
tests/test_hardcore_otb_bypass.py::test_bmv_hamming_boundary FAILED      [ 46%]
tests/test_influence_budget.py::TestInfluenceBudgetTracker::test_record_influence PASSED [ 46%]
tests/test_influence_budget.py::TestInfluenceBudgetTracker::test_baseline_update PASSED [ 46%]
tests/test_influence_budget.py::TestInfluenceBudgetTracker::test_anomaly_detection PASSED [ 46%]
tests/test_influence_budget.py::TestInfluenceBudgetTracker::test_get_influence_budget PASSED [ 47%]
tests/test_influence_budget.py::TestInfluenceBudgetTracker::test_get_top_influencers PASSED [ 47%]
tests/test_influence_budget.py::TestInfluenceBudgetTracker::test_anomaly_type_classification PASSED [ 47%]
tests/test_influence_budget.py::TestInfluenceBudgetTracker::test_get_statistics PASSED [ 47%]
tests/test_influence_budget.py::TestInfluenceBudgetTracker::test_reset_alerts PASSED [ 47%]
tests/test_influence_budget.py::TestInfluenceBudgetTracker::test_cleanup_old_records PASSED [ 47%]
tests/test_influence_budget.py::TestIntegration::test_slow_roll_poison_detection PASSED [ 47%]
tests/test_influence_budget.py::TestIntegration::test_multi_domain_tracking PASSED [ 47%]
tests/test_input_ensemble_calibration.py::test_decide_returns_qhat_and_label_changes_with_updates PASSED [ 47%]
tests/test_input_ensemble_calibration.py::test_bucket_fallback_to_global PASSED [ 48%]
tests/test_input_ensemble_calibration.py::test_weighted_aggregation PASSED [ 48%]
tests/test_nli_consistency.py::TestNLIConsistency::test_nli_max_aggregate PASSED [ 48%]
tests/test_nli_consistency.py::TestNLIConsistency::test_nli_mean_aggregate PASSED [ 48%]
tests/test_nli_consistency.py::TestNLIConsistency::test_nli_min_aggregate PASSED [ 48%]
tests/test_nli_consistency.py::TestNLIConsistency::test_empty_kb_returns_zero PASSED [ 48%]
tests/test_nli_consistency.py::TestNLIConsistency::test_no_match_returns_zero PASSED [ 48%]
tests/test_nli_consistency.py::TestNLIConsistency::test_check_contradiction_simple PASSED [ 48%]
tests/test_normalize_v2.py::test_canonicalize_basic PASSED               [ 49%]
tests/test_normalize_v2.py::test_homoglyphs_and_casefold PASSED          [ 49%]
tests/test_normalize_v2.py::test_zero_width_removal PASSED               [ 49%]
tests/test_obfuscation_guard.py::test_obfuscation_signals_detected PASSED [ 49%]
tests/test_obfuscation_guard.py::test_clean_text_low_severity PASSED     [ 49%]
tests/test_obfuscation_guard.py::test_bidi_controls_detected PASSED      [ 49%]
tests/test_obfuscation_guard.py::test_mixed_scripts_cyrillic_greek PASSED [ 49%]
tests/test_obfuscation_guard.py::test_hex_run_detected PASSED            [ 49%]
tests/test_obfuscation_guard.py::test_rot13_suspected PASSED             [ 49%]
tests/test_obfuscation_guard.py::test_severity_calculation_bounded PASSED [ 50%]
tests/test_p0_critical_fixes.py::test_adv_008_base85_adobe PASSED        [ 50%]
tests/test_p0_critical_fixes.py::test_adv_045_composition_triple_threat PASSED [ 50%]
tests/test_p0_critical_fixes.py::test_adv_002_bidi_rlo_wrap PASSED       [ 50%]
tests/test_p0_critical_fixes.py::test_adv_013_bidi_isolates PASSED       [ 50%]
tests/test_p0_critical_fixes.py::test_adv_003_homoglyph_greek_cyrillic PASSED [ 50%]
tests/test_p0_critical_fixes.py::test_adv_012_fullwidth_digits PASSED    [ 50%]
tests/test_p0_critical_fixes.py::test_adv_015_punctuation_split PASSED   [ 50%]
tests/test_p0_critical_fixes.py::test_adv_009_token_interleave PASSED    [ 50%]
tests/test_p0_critical_fixes.py::test_adv_050_spaces_fullwidth_combo PASSED [ 51%]
tests/test_p0_critical_fixes.py::test_no_false_positive_on_clean PASSED  [ 51%]
tests/test_patterns_v2.py::test_ignore_instructions_hits PASSED          [ 51%]
tests/test_patterns_v2.py::test_negation_whitelist PASSED                [ 51%]
tests/test_patterns_v2.py::test_unfiltered_mode PASSED                   [ 51%]
tests/test_patterns_v2.py::test_research_pretext PASSED                  [ 51%]
tests/test_persona_epistemik_separation.py::TestPersonaEpistemikSeparation::test_threshold_independent_of_personality PASSED [ 51%]
tests/test_persona_epistemik_separation.py::TestPersonaEpistemikSeparation::test_all_domains_personality_independent PASSED [ 51%]
tests/test_persona_epistemik_separation.py::TestPersonaEpistemikSeparation::test_threshold_equals_domain_base PASSED [ 52%]
tests/test_persona_epistemik_separation.py::TestPersonaEpistemikSeparation::test_personality_change_does_not_affect_threshold PASSED [ 52%]
tests/test_persona_epistemik_separation.py::TestPersonaEpistemikSeparation::test_feedback_learning_personality_independent PASSED [ 52%]
tests/test_persona_epistemik_separation.py::TestPersonaEpistemikSeparation::test_no_personality_getter_used_for_thresholds PASSED [ 52%]
tests/test_policy_budgets.py::test_decode_budgets_loaded PASSED          [ 52%]
tests/test_policy_budgets.py::test_auto_strict_config_loaded PASSED      [ 52%]
tests/test_policy_budgets.py::test_policy_defaults PASSED                [ 52%]
tests/test_policy_dsl_parse.py::TestPolicyLeaf::test_valid_leaf PASSED   [ 52%]
tests/test_policy_dsl_parse.py::TestPolicyCond::test_exactly_one_field_required PASSED [ 52%]
tests/test_policy_dsl_parse.py::TestParseYAMLSpec::test_parse_base_policy PASSED [ 53%]
tests/test_policy_dsl_parse.py::TestParseYAMLSpec::test_rules_sorted_by_priority PASSED [ 53%]
tests/test_policy_dsl_parse.py::TestParseYAMLSpec::test_parse_minimal_spec PASSED [ 53%]
tests/test_policy_engine_integration.py::TestPolicyEngine::test_engine_loads_base_policy PASSED [ 53%]
tests/test_policy_engine_integration.py::TestPolicyEngine::test_engine_rejects_conflicting_policy PASSED [ 53%]
tests/test_policy_engine_integration.py::TestPolicyEngine::test_decide_blocks_secrets PASSED [ 53%]
tests/test_policy_engine_integration.py::TestPolicyEngine::test_decide_allows_high_level_biohazard PASSED [ 53%]
tests/test_policy_engine_integration.py::TestPolicyEngine::test_decide_default_allow_science PASSED [ 53%]
tests/test_policy_engine_integration.py::TestPolicyEngine::test_decide_blocks_minor PASSED [ 54%]
tests/test_policy_modes.py::test_policy_from_hydra_permissive PASSED     [ 54%]
tests/test_policy_modes.py::test_policy_from_hydra_strict PASSED         [ 54%]
tests/test_policy_modes.py::test_policy_defaults PASSED                  [ 54%]
tests/test_policy_modes.py::test_weak_secret_provider_detected PASSED    [ 54%]
tests/test_policy_modes.py::test_strong_secret_provider_detected PASSED  [ 54%]
tests/test_policy_modes.py::test_no_provider_prefix PASSED               [ 54%]
tests/test_policy_sat_and_compile.py::TestConflictDetection::test_conflict_equal_priority_different_actions PASSED [ 54%]
tests/test_policy_sat_and_compile.py::TestConflictDetection::test_no_conflict_different_priorities PASSED [ 54%]
tests/test_policy_sat_and_compile.py::TestConflictDetection::test_no_conflict_disjoint_domains PASSED [ 55%]
tests/test_policy_sat_and_compile.py::TestCompilation::test_compile_base_policy PASSED [ 55%]
tests/test_policy_sat_and_compile.py::TestEvaluation::test_evaluate_block_on_secrets PASSED [ 55%]
tests/test_policy_sat_and_compile.py::TestEvaluation::test_evaluate_allow_high_level_biohazard PASSED [ 55%]
tests/test_policy_sat_and_compile.py::TestEvaluation::test_evaluate_default_allow PASSED [ 55%]
tests/test_policy_verify_invariant.py::test_invariant_holds_for_base_policy PASSED [ 55%]
tests/test_policy_verify_invariant.py::test_invariant_violation_detected PASSED [ 55%]
tests/test_policy_verify_invariant.py::test_invariant_holds_with_block PASSED [ 55%]
tests/test_prometheus_rules.py::TestPrometheusRulesYAML::test_yaml_is_valid PASSED [ 56%]
tests/test_prometheus_rules.py::TestPrometheusRulesYAML::test_contains_recording_rules PASSED [ 56%]
tests/test_prometheus_rules.py::TestPrometheusRulesYAML::test_contains_alerts PASSED [ 56%]
tests/test_prometheus_rules.py::TestPrometheusRulesYAML::test_has_asr_alert PASSED [ 56%]
tests/test_prometheus_rules.py::TestPrometheusRulesYAML::test_has_critical_leak_alert PASSED [ 56%]
tests/test_prometheus_rules.py::TestPrometheusRulesYAML::test_has_latency_alert PASSED [ 56%]
tests/test_robbins_monro.py::TestProximalRobbinsMonro::test_initialization PASSED [ 56%]
tests/test_robbins_monro.py::TestProximalRobbinsMonro::test_threshold_update_no_errors PASSED [ 56%]
tests/test_robbins_monro.py::TestProximalRobbinsMonro::test_threshold_update_high_errors PASSED [ 56%]
tests/test_robbins_monro.py::TestProximalRobbinsMonro::test_proximal_term_prevents_overshooting PASSED [ 57%]
tests/test_robbins_monro.py::TestProximalRobbinsMonro::test_learning_rate_decay PASSED [ 57%]
tests/test_robbins_monro.py::TestProximalRobbinsMonro::test_proximal_center_update PASSED [ 57%]
tests/test_robbins_monro.py::TestProximalRobbinsMonro::test_proximal_weight_decay PASSED [ 57%]
tests/test_robbins_monro.py::TestProximalRobbinsMonro::test_convergence_detection PASSED [ 57%]
tests/test_robbins_monro.py::TestProximalRobbinsMonro::test_clopper_pearson_zero_errors PASSED [ 57%]
tests/test_robbins_monro.py::TestProximalRobbinsMonro::test_clopper_pearson_one_error PASSED [ 57%]
tests/test_robbins_monro.py::TestProximalRobbinsMonro::test_cusum_drift_detection PASSED [ 57%]
tests/test_safe_bandit.py::test_offline_optim_fpr_constraint PASSED      [ 58%]
tests/test_safe_bandit.py::test_safe_ucb_simulation_safe_choice PASSED   [ 58%]
tests/test_safe_bandit.py::test_evaluate_threshold_basic PASSED          [ 58%]
tests/test_safe_bandit.py::test_optimize_threshold_no_valid_threshold PASSED [ 58%]
tests/test_safety_sandwich.py::TestLeakDetector::test_detect_password_leak PASSED [ 58%]
tests/test_safety_sandwich.py::TestLeakDetector::test_detect_api_key_leak PASSED [ 58%]
tests/test_safety_sandwich.py::TestLeakDetector::test_detect_private_key_leak PASSED [ 58%]
tests/test_safety_sandwich.py::TestLeakDetector::test_detect_secret_leak PASSED [ 58%]
tests/test_safety_sandwich.py::TestLeakDetector::test_clean_text_no_leak PASSED [ 58%]
tests/test_safety_sandwich.py::TestLeakDetector::test_find_leaks_returns_details PASSED [ 59%]
tests/test_safety_sandwich.py::TestGuardedDecode::test_aborts_on_critical_leak PASSED [ 59%]
tests/test_safety_sandwich.py::TestGuardedDecode::test_allows_clean_draft PASSED [ 59%]
tests/test_safety_sandwich.py::TestGuardedDecode::test_multiple_leaks_detected PASSED [ 59%]
tests/test_safety_sandwich.py::TestGuardedDecode::test_custom_n_tokens PASSED [ 59%]
tests/test_safety_sandwich.py::TestGuardedDecodeWithDetails::test_returns_details_on_abort PASSED [ 59%]
tests/test_safety_sandwich.py::TestGuardedDecodeWithDetails::test_returns_clean_output_details PASSED [ 59%]
tests/test_safety_sandwich_metrics.py::test_stream_abort_on_critical_leak_n PASSED [ 59%]
tests/test_safety_sandwich_metrics.py::test_redaction_on_medium_severity PASSED [ 60%]
tests/test_safety_sandwich_metrics.py::test_clean_text_continues PASSED  [ 60%]
tests/test_safety_sandwich_metrics.py::test_finalize_decision_modes PASSED [ 60%]
tests/test_safety_sandwich_v2.py::test_abort_on_high_conf_secret_early PASSED [ 60%]
tests/test_safety_sandwich_v2.py::test_wrap_on_medium_secret PASSED      [ 60%]
tests/test_safety_sandwich_v2.py::test_quarantine_on_obfuscation PASSED  [ 60%]
tests/test_safety_sandwich_v2.py::test_promote_on_clean PASSED           [ 60%]
tests/test_safety_sandwich_v2.py::test_redact_text_posthoc PASSED        [ 60%]
tests/test_safety_sandwich_v2.py::test_streaming_stride PASSED           [ 60%]
tests/test_safety_sandwich_v2.py::test_critical_leak_fires_only_once PASSED [ 61%]
tests/test_safety_validator.py::TestSafetyValidator::test_validator_initialization PASSED [ 61%]
tests/test_safety_validator.py::TestSafetyValidator::test_extract_signals_benign PASSED [ 61%]
tests/test_safety_validator.py::TestSafetyValidator::test_extract_signals_how_to PASSED [ 61%]
tests/test_safety_validator.py::TestSafetyValidator::test_extract_signals_technical PASSED [ 61%]
tests/test_safety_validator.py::TestSafetyValidator::test_extract_signals_evasion PASSED [ 61%]
tests/test_safety_validator.py::TestSafetyValidator::test_compute_risk_score PASSED [ 61%]
tests/test_safety_validator.py::TestSafetyValidator::test_validate_safe_content PASSED [ 61%]
tests/test_safety_validator.py::TestSafetyValidator::test_validate_borderline_content PASSED [ 62%]
tests/test_safety_validator.py::TestSafetyValidator::test_validate_high_risk_content PASSED [ 62%]
tests/test_safety_validator.py::TestSafetyValidator::test_is_safe_helper PASSED [ 62%]
tests/test_safety_validator.py::TestSafetyValidator::test_get_blacklist_categories PASSED [ 62%]
tests/test_safety_validator.py::TestSafetyValidator::test_category_matching PASSED [ 62%]
tests/test_safety_validator.py::TestSafetyValidator::test_blacklist_override PASSED [ 62%]
tests/test_safety_validator.py::TestSafetyValidator::test_uncertainty_effect PASSED [ 62%]
tests/test_safety_validator.py::TestIntegration::test_full_safety_pipeline PASSED [ 62%]
tests/test_safety_validator.py::TestIntegration::test_threat_detection_stack PASSED [ 62%]
tests/test_safety_validator_edge_cases.py::TestComponentFloors::test_intent_only_high_gates PASSED [ 63%]
tests/test_safety_validator_edge_cases.py::TestComponentFloors::test_capability_only_high_risk PASSED [ 63%]
tests/test_safety_validator_edge_cases.py::TestComponentFloors::test_targeting_only_escalates PASSED [ 63%]
tests/test_safety_validator_edge_cases.py::TestComponentFloors::test_evasion_only_escalates PASSED [ 63%]
tests/test_safety_validator_edge_cases.py::TestComponentFloors::test_combined_signals_stronger PASSED [ 63%]
tests/test_safety_validator_edge_cases.py::TestComponentFloors::test_benign_content_unaffected PASSED [ 63%]
tests/test_safety_validator_edge_cases.py::TestComponentFloors::test_floor_logic_deterministic PASSED [ 63%]
tests/test_safety_validator_edge_cases.py::TestComponentFloors::test_linear_floor_interaction PASSED [ 63%]
tests/test_secrets_enhanced.py::test_provider_patterns_enhanced PASSED   [ 64%]
tests/test_secrets_enhanced.py::test_base32_base58_hex_detection PASSED  [ 64%]
tests/test_secrets_enhanced.py::test_severity_scoring PASSED             [ 64%]
tests/test_secrets_enhanced.py::test_empty_and_clean_text PASSED         [ 64%]
tests/test_shingle_hasher.py::TestShingleProfile::test_profile_creation PASSED [ 64%]
tests/test_shingle_hasher.py::TestShingleHasher::test_text_normalization PASSED [ 64%]
tests/test_shingle_hasher.py::TestShingleHasher::test_shingle_extraction PASSED [ 64%]
tests/test_shingle_hasher.py::TestShingleHasher::test_shingle_extraction_short_text PASSED [ 64%]
tests/test_shingle_hasher.py::TestShingleHasher::test_create_profile PASSED [ 64%]
tests/test_shingle_hasher.py::TestShingleHasher::test_create_profile_empty PASSED [ 65%]
tests/test_shingle_hasher.py::TestShingleHasher::test_add_baseline_profile PASSED [ 65%]
tests/test_shingle_hasher.py::TestShingleHasher::test_kl_divergence_identical PASSED [ 65%]
tests/test_shingle_hasher.py::TestShingleHasher::test_kl_divergence_different PASSED [ 65%]
tests/test_shingle_hasher.py::TestShingleHasher::test_frequency_spikes_detection PASSED [ 65%]
tests/test_shingle_hasher.py::TestShingleHasher::test_near_duplicates_detection PASSED [ 65%]
tests/test_shingle_hasher.py::TestShingleHasher::test_detect_anomalies_comprehensive PASSED [ 65%]
tests/test_shingle_hasher.py::TestShingleHasher::test_get_baseline_stats PASSED [ 65%]
tests/test_shingle_hasher.py::TestShingleHasher::test_min_frequency_filtering PASSED [ 66%]
tests/test_shingle_hasher.py::TestShingleHasher::test_different_n_gram_sizes PASSED [ 66%]
tests/test_shingle_hasher.py::TestIntegration::test_full_poison_detection_pipeline PASSED [ 66%]
tests/test_shingle_hasher.py::TestIntegration::test_performance_with_large_content PASSED [ 66%]
tests/test_snapshot_canaries.py::TestCanaryClaim::test_canary_creation PASSED [ 66%]
tests/test_snapshot_canaries.py::TestSnapshotCanaries::test_canary_creation PASSED [ 66%]
tests/test_snapshot_canaries.py::TestSnapshotCanaries::test_baseline_scores_computed PASSED [ 66%]
tests/test_snapshot_canaries.py::TestSnapshotCanaries::test_check_drift_no_drift PASSED [ 66%]
tests/test_snapshot_canaries.py::TestSnapshotCanaries::test_check_drift_with_drift PASSED [ 66%]
tests/test_snapshot_canaries.py::TestSnapshotCanaries::test_check_false_entailments PASSED [ 67%]
tests/test_snapshot_canaries.py::TestSnapshotCanaries::test_get_canary_stats PASSED [ 67%]
tests/test_snapshot_canaries.py::TestSnapshotCanaries::test_add_custom_canary PASSED [ 67%]
tests/test_snapshot_canaries.py::TestSnapshotCanaries::test_drift_threshold_effect PASSED [ 67%]
tests/test_snapshot_canaries.py::TestSnapshotCanaries::test_sample_size_effect PASSED [ 67%]
tests/test_snapshot_canaries.py::TestSnapshotCanaries::test_canary_categories PASSED [ 67%]
tests/test_snapshot_canaries.py::TestIntegration::test_full_pipeline_simulation PASSED [ 67%]
tests/test_stacking.py::test_fit_and_decide_shapes SKIPPED (scikit-learn
not available)                                                           [ 67%]
tests/test_stacking.py::test_conformal_floor SKIPPED (scikit-learn not
available)                                                               [ 67%]
tests/test_stage4_challenge.py::test_v4_interleave_homoglyph_bidi_blocks PASSED [ 68%]
tests/test_stage4_challenge.py::test_v4_data_gzip_hidden_secret PASSED   [ 68%]
tests/test_stage4_challenge.py::test_v4_data_zip_hidden_secret PASSED    [ 68%]
tests/test_stage4_challenge.py::test_v4_base91_like_secret XPASSuristics) [ 68%]
tests/test_stage4_challenge.py::test_v4_png_text_chunk_secret PASSED     [ 68%]
tests/test_stage4_challenge.py::test_v4_provider_near_miss_warns PASSED  [ 68%]
tests/test_stage4_challenge.py::test_v4_session_slow_roll_trips_evalue PASSED [ 68%]
tests/test_stage4_challenge.py::test_v4_locale_spanish_portuguese_labels PASSED [ 68%]
tests/test_stage4_challenge.py::test_v4_zero_width_html_entities PASSED  [ 69%]
tests/test_stage4_challenge.py::test_v4_mode_permissive_allows_bare_sha256 PASSED [ 69%]
tests/test_stage4_challenge.py::test_v4_mode_strict_warns_bare_sha256 PASSED [ 69%]
tests/test_stage5_gauntlet.py::test_v5_rfc2047_encoded_word_warns PASSED [ 69%]
tests/test_stage5_gauntlet.py::test_v5_jpeg_exif_text PASSED             [ 69%]
tests/test_stage5_gauntlet.py::test_v5_pdf_visible_text PASSED           [ 69%]
tests/test_stage5_gauntlet.py::test_v5_json_key_bidi PASSED              [ 69%]
tests/test_stage5_gauntlet.py::test_v5_yaml_anchor_alias PASSED          [ 69%]
tests/test_stage5_gauntlet.py::test_v5_combining_flood PASSED            [ 69%]
tests/test_stage5_gauntlet.py::test_v5_slow_roll_one_char PASSED         [ 70%]
tests/test_stage5_gauntlet.py::test_v5_modes_rfc2047 PASSED              [ 70%]
tests/test_stage5_gauntlet.py::test_v5_base2048_future XPASS (base2048
not implemented; add heuristic/decoder later)                            [ 70%]
tests/test_stage5_gauntlet.py::test_v5_rot47_b64_chain XPASS (ROT47
chain not implemented; add layered decode heuristic)                     [ 70%]
tests/test_statistics_tracker.py::test_empty_statistics PASSED           [ 70%]
tests/test_statistics_tracker.py::test_decision_counts_no_feedback PASSED [ 70%]
tests/test_statistics_tracker.py::test_accuracy_metrics_with_feedback PASSED [ 70%]
tests/test_statistics_tracker.py::test_convergence_learning_phase PASSED [ 70%]
tests/test_statistics_tracker.py::test_convergence_converged PASSED      [ 71%]
tests/test_statistics_tracker.py::test_convergence_converging PASSED     [ 71%]
tests/test_statistics_tracker.py::test_gt_score_distribution PASSED      [ 71%]
tests/test_statistics_tracker.py::test_time_window_filtering PASSED      [ 71%]
tests/test_statistics_tracker.py::test_precision_recall_edge_cases PASSED [ 71%]
tests/test_statistics_tracker.py::test_f1_score_computation PASSED       [ 71%]
tests/test_temporal_gate.py::TestIsoDurationParsing::test_parse_months_only PASSED [ 71%]
tests/test_temporal_gate.py::TestIsoDurationParsing::test_parse_years_and_months PASSED [ 71%]
tests/test_temporal_gate.py::TestIsoDurationParsing::test_parse_all_components PASSED [ 71%]
tests/test_temporal_gate.py::TestIsoDurationParsing::test_parse_days_only PASSED [ 72%]
tests/test_temporal_gate.py::TestIsoDurationParsing::test_parse_invalid_format_raises PASSED [ 72%]
tests/test_temporal_gate.py::TestDurationToDays::test_years_to_days PASSED [ 72%]
tests/test_temporal_gate.py::TestDurationToDays::test_months_to_days PASSED [ 72%]
tests/test_temporal_gate.py::TestDurationToDays::test_combined_duration PASSED [ 72%]
tests/test_temporal_gate.py::TestTimeAwarenessGate::test_initialization_with_valid_ttl PASSED [ 72%]
tests/test_temporal_gate.py::TestTimeAwarenessGate::test_initialization_with_invalid_ttl_raises PASSED [ 72%]
tests/test_temporal_gate.py::TestTimeAwarenessGate::test_stale_evidence_with_penalty PASSED [ 72%]
tests/test_temporal_gate.py::TestTimeAwarenessGate::test_fresh_evidence_no_penalty PASSED [ 73%]
tests/test_temporal_gate.py::TestTimeAwarenessGate::test_grace_period_applies PASSED [ 73%]
tests/test_temporal_gate.py::TestTimeAwarenessGate::test_unknown_domain_raises PASSED [ 73%]
tests/test_temporal_gate.py::TestTimeAwarenessGate::test_time_travel_raises PASSED [ 73%]
tests/test_temporal_gate.py::TestTimeAwarenessGate::test_configured_domains PASSED [ 73%]
tests/test_unicode_hardening_advanced.py::test_fullwidth_digits_normalized PASSED [ 73%]
tests/test_unicode_hardening_advanced.py::test_confusable_mapping PASSED [ 73%]
tests/test_unicode_hardening_advanced.py::test_zero_width_stripped PASSED [ 73%]
tests/test_unicode_hardening_advanced.py::test_bidi_isolates_detected PASSED [ 73%]
tests/test_unicode_hardening_advanced.py::test_strip_rematch_interleave PASSED [ 74%]
tests/test_unicode_hardening_advanced.py::test_strip_rematch_punctuation PASSED [ 74%]
tests/test_unicode_hardening_advanced.py::test_spaces_plus_fullwidth PASSED [ 74%]
tests/test_unicode_hardening_advanced.py::test_nfkc_plus_comprehensive PASSED [ 74%]
tests/test_unicode_hardening_advanced.py::test_no_false_positive_clean_text PASSED [ 74%]
tests/test_windowed_hotpath.py::test_windowed_detection_longtext PASSED  [ 74%]
tests/test_windowed_hotpath.py::test_windowed_vs_nonwindowed PASSED      [ 74%]
tests/test_windowed_hotpath.py::test_short_text_no_windowing PASSED      [ 74%]
tests/test_write_log_adapter.py::TestWriteLogEntry::test_valid_entry PASSED [ 75%]
tests/test_write_log_adapter.py::TestWriteLogEntry::test_invalid_content_hash_length PASSED [ 75%]
tests/test_write_log_adapter.py::TestWriteLogEntry::test_invalid_parent_hash_length PASSED [ 75%]
tests/test_write_log_adapter.py::TestWriteLogEntry::test_trust_out_of_range PASSED [ 75%]
tests/test_write_log_adapter.py::TestMerkleChainBuilder::test_hash_content PASSED [ 75%]
tests/test_write_log_adapter.py::TestMerkleChainBuilder::test_hash_bytes PASSED [ 75%]
tests/test_write_log_adapter.py::TestMerkleChainBuilder::test_create_genesis_entry PASSED [ 75%]
tests/test_write_log_adapter.py::TestMerkleChainBuilder::test_create_chained_entry PASSED [ 75%]
tests/test_write_log_adapter.py::TestTransparencyLogAdapter::test_append_write_genesis SKIPPED [ 75%]
tests/test_write_log_adapter.py::TestTransparencyLogAdapter::test_append_write_chained SKIPPED [ 76%]
tests/test_write_log_adapter.py::TestTransparencyLogAdapter::test_append_duplicate_hash_raises SKIPPED [ 76%]
tests/test_write_log_adapter.py::TestTransparencyLogAdapter::test_get_latest_hash SKIPPED [ 76%]
tests/test_write_log_adapter.py::TestTransparencyLogAdapter::test_get_chain_stats SKIPPED [ 76%]
tests/test_write_log_adapter.py::TestTransparencyLogAdapter::test_quarantine_workflow SKIPPED [ 76%]
tests/test_write_log_adapter.py::TestTransparencyLogAdapter::test_quarantine_reject SKIPPED [ 76%]
tests/test_write_policy.py::TestSourceMetadata::test_valid_metadata PASSED [ 76%]
tests/test_write_policy.py::TestSourceMetadata::test_trust_out_of_range PASSED [ 76%]
tests/test_write_policy.py::TestWriteDecision::test_valid_allow_decision PASSED [ 77%]
tests/test_write_policy.py::TestWriteDecision::test_valid_quarantine_decision PASSED [ 77%]
tests/test_write_policy.py::TestWriteDecision::test_quarantine_without_reason_raises PASSED [ 77%]
tests/test_write_policy.py::TestWriteDecision::test_confidence_out_of_range PASSED [ 77%]
tests/test_write_policy.py::TestWritePathPolicy::test_initialization_defaults PASSED [ 77%]
tests/test_write_policy.py::TestWritePathPolicy::test_initialization_custom PASSED [ 77%]
tests/test_write_policy.py::TestWritePathPolicy::test_self_authored_denied PASSED [ 77%]
tests/test_write_policy.py::TestWritePathPolicy::test_circular_ref_quarantine PASSED [ 77%]
tests/test_write_policy.py::TestWritePathPolicy::test_low_trust_quarantine PASSED [ 77%]
tests/test_write_policy.py::TestWritePathPolicy::test_short_ttl_quarantine PASSED [ 78%]
tests/test_write_policy.py::TestWritePathPolicy::test_domain_specific_ttl PASSED [ 78%]
tests/test_write_policy.py::TestWritePathPolicy::test_high_risk_domain_quarantine PASSED [ 78%]
tests/test_write_policy.py::TestWritePathPolicy::test_all_checks_pass_allow PASSED [ 78%]
tests/test_write_policy.py::TestWritePathPolicy::test_get_domain_ttl_hours PASSED [ 78%]
tests/test_write_policy.py::TestWritePathPolicy::test_is_high_risk_domain PASSED [ 78%]
tests/test_yaml_alias_assembler.py::test_simple_alias_expansion PASSED   [ 78%]
tests/test_yaml_alias_assembler.py::test_secret_reassembly PASSED        [ 78%]
tests/test_yaml_alias_assembler.py::test_bounded_expansion PASSED        [ 79%]
tests/test_yaml_alias_assembler.py::test_multiple_aliases_per_line PASSED [ 79%]
tests/test_yaml_alias_assembler.py::test_no_aliases_passthrough PASSED   [ 79%]
tests_firewall/test_ast_gating.py::test_extracts_string_literals PASSED  [ 79%]
tests_firewall/test_ast_gating.py::test_ignores_identifiers PASSED       [ 79%]
tests_firewall/test_ast_gating.py::test_extracts_comments PASSED         [ 79%]
tests_firewall/test_ast_gating.py::test_fallback_on_malformed PASSED     [ 79%]
tests_firewall/test_ast_gating.py::test_scannable_parts_code_context PASSED [ 79%]
tests_firewall/test_ast_gating.py::test_scannable_parts_natural_context PASSED [ 79%]
tests_firewall/test_b64_multiline_strict.py::test_short_strings_in_code_do_not_trigger PASSED [ 80%]
tests_firewall/test_b64_multiline_strict.py::test_shebang_and_imports_do_not_trigger PASSED [ 80%]
tests_firewall/test_b64_multiline_strict.py::test_two_decodable_lines_trigger PASSED [ 80%]
tests_firewall/test_b64_multiline_strict.py::test_single_long_token_triggers PASSED [ 80%]
tests_firewall/test_b64_multiline_strict.py::test_textual_decoded_short_is_ignored PASSED [ 80%]
tests_firewall/test_b64_multiline_strict.py::test_context_code_stricter_than_natural PASSED [ 80%]
tests_firewall/test_b64_multiline_strict.py::test_strict_returns_spans PASSED [ 80%]
tests_firewall/test_b64_multiline_strict.py::test_non_decodable_high_ratio_ignored PASSED [ 80%]
tests_firewall/test_b64_multiline_strict.py::test_real_attack_multiline_detected PASSED [ 81%]
tests_firewall/test_final_boss_attack.py::test_final_boss_ultimate_obfuscation PASSED [ 81%]
tests_firewall/test_final_boss_attack.py::test_final_boss_multilayer_encoding PASSED [ 81%]
tests_firewall/test_final_boss_attack.py::test_final_boss_polyglot_monster PASSED [ 81%]
tests_firewall/test_otb_gates.py::test_msg_perturbations PASSED          [ 81%]
tests_firewall/test_otb_gates.py::test_msg_stable_decision PASSED        [ 81%]
tests_firewall/test_otb_gates.py::test_msg_unstable_downgrades PASSED    [ 81%]
tests_firewall/test_otb_gates.py::test_simhash_deterministic PASSED      [ 81%]
tests_firewall/test_otb_gates.py::test_hamming_distance PASSED           [ 81%]
tests_firewall/test_otb_gates.py::test_benign_vault_add_and_check PASSED [ 82%]
tests_firewall/test_otb_gates.py::test_executability_json PASSED         [ 82%]
tests_firewall/test_otb_gates.py::test_executability_python PASSED       [ 82%]
tests_firewall/test_otb_gates.py::test_executability_with_strong_bypass PASSED [ 82%]
tests_firewall/test_otb_gates.py::test_k_of_n_single_family FAILED       [ 82%]
tests_firewall/test_otb_gates.py::test_k_of_n_multiple_families PASSED   [ 82%]
tests_firewall/test_otb_gates.py::test_k_of_n_strong_bypass PASSED       [ 82%]
tests_firewall/test_otb_gates.py::test_feature_families_complete PASSED  [ 82%]
tests_firewall/test_p2_fpr_weights.py::test_co_occurrence_gate_without_transport FAILED [ 83%]
tests_firewall/test_p2_fpr_weights.py::test_co_occurrence_gate_with_transport PASSED [ 83%]
tests_firewall/test_p2_fpr_weights.py::test_indicator_gate_code_context FAILED [ 83%]
tests_firewall/test_p2_fpr_weights.py::test_indicator_gate_with_strong PASSED [ 83%]
tests_firewall/test_p2_fpr_weights.py::test_indicator_gate_multiple_indicators PASSED [ 83%]
tests_firewall/test_p2_fpr_weights.py::test_context_dampening_conservative PASSED [ 83%]
tests_firewall/test_p2_fpr_weights.py::test_dev_placeholder PASSED       [ 83%]
tests_firewall/test_p2_fpr_weights.py::test_decide_action_thresholds FAILED [ 83%]
tests_firewall/test_p2_fpr_weights.py::test_transport_decode_indicators_complete FAILED [ 83%]
tests_firewall/test_p2_fpr_weights.py::test_weak_signals_reduced FAILED  [ 84%]
tests_firewall/test_p31_minis.py::test_media_b64_is_pass_or_warn_in_code PASSED [ 84%]
tests_firewall/test_p31_minis.py::test_secretlike_blocks_in_code PASSED  [ 84%]
tests_firewall/test_p31_minis.py::test_exotic_in_comment_neutralized PASSED [ 84%]
tests_firewall/test_p31_minis.py::test_exotic_in_identifier_is_warn_or_block FAILED [ 84%]
tests_firewall/test_p31_minis.py::test_mixed_script_identifier_blocks FAILED [ 84%]
tests_firewall/test_p31_minis.py::test_bidi_natural_blocks PASSED        [ 84%]
tests_firewall/test_rc7_deepseek_gaps.py::test_indirect_bracket_concat PASSED [ 84%]
tests_firewall/test_rc7_deepseek_gaps.py::test_indirect_array_join PASSED [ 84%]
tests_firewall/test_rc7_deepseek_gaps.py::test_indirect_function_constructor PASSED [ 85%]
tests_firewall/test_rc7_deepseek_gaps.py::test_indirect_settimeout_string PASSED [ 85%]
tests_firewall/test_rc7_deepseek_gaps.py::test_indirect_settimeout_call PASSED [ 85%]
tests_firewall/test_rc7_deepseek_gaps.py::test_indirect_location_href PASSED [ 85%]
tests_firewall/test_rc7_deepseek_gaps.py::test_indirect_dynamic_import PASSED [ 85%]
tests_firewall/test_rc7_deepseek_gaps.py::test_indirect_prototype_pollution PASSED [ 85%]
tests_firewall/test_rc7_deepseek_gaps.py::test_indirect_eval_call PASSED [ 85%]
tests_firewall/test_rc7_deepseek_gaps.py::test_indirect_with_statement PASSED [ 85%]
tests_firewall/test_rc7_deepseek_gaps.py::test_indirect_template_literal PASSED [ 86%]
tests_firewall/test_rc7_deepseek_gaps.py::test_multimodal_svg_script PASSED [ 86%]
tests_firewall/test_rc7_deepseek_gaps.py::test_multimodal_svg_onload PASSED [ 86%]
tests_firewall/test_rc7_deepseek_gaps.py::test_multimodal_mathml_script PASSED [ 86%]
tests_firewall/test_rc7_deepseek_gaps.py::test_multimodal_mathml_action PASSED [ 86%]
tests_firewall/test_rc7_deepseek_gaps.py::test_multimodal_css_import_javascript PASSED [ 86%]
tests_firewall/test_rc7_deepseek_gaps.py::test_multimodal_css_import_data PASSED [ 86%]
tests_firewall/test_rc7_deepseek_gaps.py::test_multimodal_css_expression PASSED [ 86%]
tests_firewall/test_rc7_deepseek_gaps.py::test_multimodal_css_url_javascript PASSED [ 86%]
tests_firewall/test_rc7_deepseek_gaps.py::test_multimodal_style_script_combo PASSED [ 87%]
tests_firewall/test_rc7_deepseek_gaps.py::test_multimodal_svg_external PASSED [ 87%]
tests_firewall/test_rc7_deepseek_gaps.py::test_combo_svg_indirect PASSED [ 87%]
tests_firewall/test_rc7_deepseek_gaps.py::test_combo_mathml_function_constructor PASSED [ 87%]
tests_firewall/test_rc7_deepseek_gaps.py::test_combo_css_settimeout PASSED [ 87%]
tests_firewall/test_rc7_deepseek_gaps.py::test_combo_svg_emoji_indirect PASSED [ 87%]
tests_firewall/test_rc7_deepseek_gaps.py::test_combo_mathml_multilingual_import PASSED [ 87%]
tests_firewall/test_rc7_deepseek_gaps.py::test_context_poison_doc_eval PASSED [ 87%]
tests_firewall/test_rc7_deepseek_gaps.py::test_context_poison_html_comment_script PASSED [ 88%]
tests_firewall/test_rc7_deepseek_gaps.py::test_context_poison_code_split PASSED [ 88%]
tests_firewall/test_rc7_deepseek_gaps.py::test_context_poison_python_docstring PASSED [ 88%]
tests_firewall/test_rc7_deepseek_gaps.py::test_context_poison_example_function_constructor PASSED [ 88%]
tests_firewall/test_rc7_deepseek_gaps.py::test_deep_combo_svg_emoji_multilingual_indirect PASSED [ 88%]
tests_firewall/test_rc7_deepseek_gaps.py::test_deep_combo_mathml_context_poison_import PASSED [ 88%]
tests_firewall/test_tri_key_enforcement.py::TestTriKeyGate::test_entropy_suppressed_without_keys PASSED [ 88%]
tests_firewall/test_tri_key_enforcement.py::TestTriKeyGate::test_entropy_passes_with_transport PASSED [ 88%]
tests_firewall/test_tri_key_enforcement.py::TestTriKeyGate::test_entropy_passes_with_unicode_obfuscation PASSED [ 88%]
tests_firewall/test_tri_key_enforcement.py::TestTriKeyGate::test_entropy_passes_with_strong_signal PASSED [ 89%]
tests_firewall/test_tri_key_enforcement.py::TestTriKeyGate::test_non_entropy_signals_always_pass PASSED [ 89%]
tests_firewall/test_tri_key_enforcement.py::TestTriKeyEnforcementIntegration::test_entropy_only_suppressed PASSED [ 89%]
tests_firewall/test_tri_key_enforcement.py::TestTriKeyEnforcementIntegration::test_entropy_plus_transport_counts PASSED [ 89%]
tests_firewall/test_tri_key_enforcement.py::TestTriKeyEnforcementIntegration::test_entropy_plus_unicode_counts PASSED [ 89%]
tests_firewall/test_tri_key_enforcement.py::TestTriKeyEnforcementIntegration::test_entropy_plus_strong_counts PASSED [ 89%]
tests_firewall/test_tri_key_enforcement.py::TestTriKeyEnforcementIntegration::test_unicode_only_attack_blocked PASSED [ 89%]
tests_firewall/test_tri_key_enforcement.py::TestTriKeyEnforcementIntegration::test_benign_code_entropy_suppressed PASSED [ 89%]
tests_firewall/test_tri_key_enforcement.py::TestBypassCoverage::test_fullwidth_base64_closed PASSED [ 90%]
tests_firewall/test_tri_key_enforcement.py::TestBypassCoverage::test_combining_marks_closed PASSED [ 90%]
tests_firewall/test_tri_key_enforcement.py::TestBypassCoverage::test_ligature_attack_closed PASSED [ 90%]
tests_firewall/test_two_key_enforcement.py::test_entropy_without_transport_eliminated FAILED [ 90%]
tests_firewall/test_two_key_enforcement.py::test_entropy_with_transport_counts PASSED [ 90%]
tests_firewall/test_two_key_enforcement.py::test_entropy_with_multiline_counts PASSED [ 90%]
tests_firewall/test_two_key_enforcement.py::test_entropy_with_chain_decoded_counts PASSED [ 90%]
tests_firewall/test_two_key_enforcement.py::test_normal_code_no_false_positive PASSED [ 90%]
tests_firewall/test_two_key_enforcement.py::test_config_with_entropy_no_transport PASSED [ 90%]
tests_firewall/test_two_key_enforcement.py::test_attack_with_transport_and_entropy PASSED [ 91%]
tests_firewall/test_ultra_break_v2.py::test_utf7_simple PASSED           [ 91%]
tests_firewall/test_ultra_break_v2.py::test_utf7_nested PASSED           [ 91%]
tests_firewall/test_ultra_break_v2.py::test_base32_payload PASSED        [ 91%]
tests_firewall/test_ultra_break_v2.py::test_base58_like PASSED           [ 91%]
tests_firewall/test_ultra_break_v2.py::test_rfc2047_folded PASSED        [ 91%]
tests_firewall/test_ultra_break_v2.py::test_rfc2047_qp PASSED            [ 91%]
tests_firewall/test_ultra_break_v2.py::test_data_uri_base64 PASSED       [ 91%]
tests_firewall/test_ultra_break_v2.py::test_data_uri_in_markdown PASSED  [ 92%]
tests_firewall/test_ultra_break_v2.py::test_css_hex_escape PASSED        [ 92%]
tests_firewall/test_ultra_break_v2.py::test_js_unicode_escape PASSED     [ 92%]
tests_firewall/test_ultra_break_v2.py::test_rtf_hex_chain PASSED         [ 92%]
tests_firewall/test_ultra_break_v2.py::test_fullwidth_chain PASSED       [ 92%]
tests_firewall/test_ultra_break_v2.py::test_fullwidth_mixed_base64 PASSED [ 92%]
tests_firewall/test_ultra_break_v2.py::test_zw_ladder PASSED             [ 92%]
tests_firewall/test_ultra_break_v2.py::test_zwsp_between_base64 PASSED   [ 92%]
tests_firewall/test_ultra_break_v2.py::test_json_unicode_escape PASSED   [ 92%]
tests_firewall/test_ultra_break_v2.py::test_bidi_utf7 PASSED             [ 93%]
tests_firewall/test_ultra_break_v2.py::test_fullwidth_rfc2047 PASSED     [ 93%]
tests_firewall/test_ultra_break_v2.py::test_zw_data_uri PASSED           [ 93%]
tests_firewall/test_ultra_break_v2.py::test_base32_in_base64 PASSED      [ 93%]
tests_firewall/test_ultra_break_v2.py::test_rot13_base64 PASSED          [ 93%]
tests_firewall/test_ultra_break_v2.py::test_homoglyph_latin_cyrillic PASSED [ 93%]
tests_firewall/test_ultra_break_v2.py::test_homoglyph_greek PASSED       [ 93%]
tests_firewall/test_ultra_break_v3_exotic.py::test_unicode_tag_block PASSED [ 93%]
tests_firewall/test_ultra_break_v3_exotic.py::test_variation_selector_15 PASSED [ 94%]
tests_firewall/test_ultra_break_v3_exotic.py::test_variation_selector_16 PASSED [ 94%]
tests_firewall/test_ultra_break_v3_exotic.py::test_jwt_split_zwsp PASSED [ 94%]
tests_firewall/test_ultra_break_v3_exotic.py::test_jwt_partial_with_bidi PASSED [ 94%]
tests_firewall/test_ultra_break_v3_exotic.py::test_idna_punycode PASSED  [ 94%]
tests_firewall/test_ultra_break_v3_exotic.py::test_homoglyph_domain PASSED [ 94%]
tests_firewall/test_ultra_break_v3_exotic.py::test_soft_hyphen_split PASSED [ 94%]
tests_firewall/test_ultra_break_v3_exotic.py::test_nbsp_obfuscation PASSED [ 94%]
tests_firewall/test_ultra_break_v3_exotic.py::test_combining_diacritics PASSED [ 94%]
tests_firewall/test_ultra_break_v3_exotic.py::test_base32_qp_chain PASSED [ 95%]
tests_firewall/test_ultra_break_v3_exotic.py::test_base64_rot13_base64 PASSED [ 95%]
tests_firewall/test_ultra_break_v3_exotic.py::test_rtf_control_words PASSED [ 95%]
tests_firewall/test_ultra_break_v3_exotic.py::test_qp_soft_breaks PASSED [ 95%]
tests_firewall/test_ultra_break_v3_exotic.py::test_ascii85_adobe PASSED  [ 95%]
tests_firewall/test_ultra_break_v3_exotic.py::test_hex_escape_variants PASSED [ 95%]
tests_firewall/test_ultra_break_v3_exotic.py::test_nfkc_decomposition PASSED [ 95%]
tests_firewall/test_ultra_break_v3_exotic.py::test_zwj_emoji_modifier PASSED [ 95%]
tests_firewall/test_ultra_break_v3_exotic.py::test_mathematical_bold PASSED [ 96%]
tests_firewall/test_ultra_break_v3_exotic.py::test_enclosed_alphanumerics PASSED [ 96%]
tests_firewall/test_ultra_break_v4_dos.py::test_zalgo_massive_combining PASSED [ 96%]
tests_firewall/test_ultra_break_v4_dos.py::test_bidi_storm PASSED        [ 96%]
tests_firewall/test_ultra_break_v4_dos.py::test_mvs_storm PASSED         [ 96%]
tests_firewall/test_ultra_break_v4_dos.py::test_fullwidth_flood PASSED   [ 96%]
tests_firewall/test_ultra_break_v4_dos.py::test_huge_base64_like PASSED  [ 96%]
tests_firewall/test_ultra_break_v4_dos.py::test_qp_soft_break_lawine PASSED [ 96%]
tests_firewall/test_ultra_break_v4_dos.py::test_deep_json_braces PASSED  [ 96%]
tests_firewall/test_ultra_break_v4_dos.py::test_surrogate_soup PASSED    [ 97%]
tests_firewall/test_ultra_break_v4_dos.py::test_zalgo_base64_combo PASSED [ 97%]
tests_firewall/test_ultra_break_v4_dos.py::test_bidi_fullwidth_flood PASSED [ 97%]
tests_firewall/test_ultra_break_v4_dos.py::test_massive_zw_injection PASSED [ 97%]
tests_firewall/test_ultra_break_v4_dos.py::test_polyglot_unicode_all_scripts PASSED [ 97%]
tests_firewall/test_ultra_break_v4_dos.py::test_stress_all_exotic_combined PASSED [ 97%]
tests_firewall/test_ultra_break_v5_metamorph.py::test_order_unicode_then_base64 PASSED [ 97%]
tests_firewall/test_ultra_break_v5_metamorph.py::test_order_base64_then_unicode PASSED [ 97%]
tests_firewall/test_ultra_break_v5_metamorph.py::test_order_bidi_wraps_base64 PASSED [ 98%]
tests_firewall/test_ultra_break_v5_metamorph.py::test_order_base64_wraps_bidi PASSED [ 98%]
tests_firewall/test_ultra_break_v5_metamorph.py::test_context_code_fence_in_natural PASSED [ 98%]
tests_firewall/test_ultra_break_v5_metamorph.py::test_context_natural_in_code_fence PASSED [ 98%]
tests_firewall/test_ultra_break_v5_metamorph.py::test_context_config_disguised_as_code PASSED [ 98%]
tests_firewall/test_ultra_break_v5_metamorph.py::test_triple_unicode_base64_json PASSED [ 98%]
tests_firewall/test_ultra_break_v5_metamorph.py::test_quad_bidi_zw_homoglyph_base64 PASSED [ 98%]
tests_firewall/test_ultra_break_v5_metamorph.py::test_penta_all_unicode_families PASSED [ 98%]
tests_firewall/test_ultra_break_v5_metamorph.py::test_base64_split_across_lines PASSED [ 98%]
tests_firewall/test_ultra_break_v5_metamorph.py::test_base64_split_with_comments FAILED [ 99%]
tests_firewall/test_ultra_break_v5_metamorph.py::test_base64_with_whitespace_injection PASSED [ 99%]
tests_firewall/test_ultra_break_v6_session.py::test_slow_roll_base64_fragments PASSED [ 99%]
tests_firewall/test_ultra_break_v6_session.py::test_slow_roll_bidi_progressive PASSED [ 99%]
tests_firewall/test_ultra_break_v6_session.py::test_session_context_drift_natural_to_code PASSED [ 99%]
tests_firewall/test_ultra_break_v6_session.py::test_session_red_herring PASSED [ 99%]
tests_firewall/test_ultra_break_v6_session.py::test_ewma_dilution_benign_flood PASSED [ 99%]
tests_firewall/test_ultra_break_v6_session.py::test_noise_unicode_in_base64 PASSED [ 99%]
tests_firewall/test_ultra_break_v6_session.py::test_noise_comments_in_payload PASSED [100%]

================================== FAILURES ===================================
__________________________ test_msg_stable_malicious __________________________
tests\test_hardcore_otb_bypass.py:53: in test_msg_stable_malicious
    hits = run_detectors(payload)
           ^^^^^^^^^^^^^^^^^^^^^^
tests\test_hardcore_otb_bypass.py:36: in run_detectors
    decoded, stages, _ = try_decode_chain(text)
    ^^^^^^^^^^^^^^^^^^
E   ValueError: too many values to unpack (expected 3)
_____________________ test_k_of_n_single_family_overload ______________________
tests\test_hardcore_otb_bypass.py:72: in test_k_of_n_single_family_overload
    hits = run_detectors(payload)
           ^^^^^^^^^^^^^^^^^^^^^^
tests\test_hardcore_otb_bypass.py:36: in run_detectors
    decoded, stages, _ = try_decode_chain(text)
    ^^^^^^^^^^^^^^^^^^
E   ValueError: too many values to unpack (expected 3)
_________________ test_executability_bypass_valid_code_hidden _________________
tests\test_hardcore_otb_bypass.py:95: in test_executability_bypass_valid_code_hidden
    hits = run_detectors(payload)
           ^^^^^^^^^^^^^^^^^^^^^^
tests\test_hardcore_otb_bypass.py:36: in run_detectors
    decoded, stages, _ = try_decode_chain(text)
    ^^^^^^^^^^^^^^^^^^
E   ValueError: too many values to unpack (expected 3)
___________________ test_co_occurrence_bypass_entropy_alone ___________________
tests\test_hardcore_otb_bypass.py:112: in test_co_occurrence_bypass_entropy_alone
    hits = run_detectors(payload)
           ^^^^^^^^^^^^^^^^^^^^^^
tests\test_hardcore_otb_bypass.py:36: in run_detectors
    decoded, stages, _ = try_decode_chain(text)
    ^^^^^^^^^^^^^^^^^^
E   ValueError: too many values to unpack (expected 3)
___________________ test_indicator_gate_bypass_code_single ____________________
tests\test_hardcore_otb_bypass.py:126: in test_indicator_gate_bypass_code_single
    hits = run_detectors(payload)
           ^^^^^^^^^^^^^^^^^^^^^^
tests\test_hardcore_otb_bypass.py:36: in run_detectors
    decoded, stages, _ = try_decode_chain(text)
    ^^^^^^^^^^^^^^^^^^
E   ValueError: too many values to unpack (expected 3)
__________________________ test_bmv_near_miss_attack __________________________
tests\test_hardcore_otb_bypass.py:141: in test_bmv_near_miss_attack
    hits = run_detectors(payload)
           ^^^^^^^^^^^^^^^^^^^^^^
tests\test_hardcore_otb_bypass.py:36: in run_detectors
    decoded, stages, _ = try_decode_chain(text)
    ^^^^^^^^^^^^^^^^^^
E   ValueError: too many values to unpack (expected 3)
________________________ test_multi_gate_bypass_combo _________________________
tests\test_hardcore_otb_bypass.py:161: in test_multi_gate_bypass_combo
    hits = run_detectors(payload)
           ^^^^^^^^^^^^^^^^^^^^^^
tests\test_hardcore_otb_bypass.py:36: in run_detectors
    decoded, stages, _ = try_decode_chain(text)
    ^^^^^^^^^^^^^^^^^^
E   ValueError: too many values to unpack (expected 3)
________________________ test_msg_metamorphic_evasion _________________________
tests\test_hardcore_otb_bypass.py:177: in test_msg_metamorphic_evasion
    hits = run_detectors(payload)
           ^^^^^^^^^^^^^^^^^^^^^^
tests\test_hardcore_otb_bypass.py:36: in run_detectors
    decoded, stages, _ = try_decode_chain(text)
    ^^^^^^^^^^^^^^^^^^
E   ValueError: too many values to unpack (expected 3)
__________________________ test_zero_family_stealth ___________________________
tests\test_hardcore_otb_bypass.py:195: in test_zero_family_stealth
    hits = run_detectors(payload)
           ^^^^^^^^^^^^^^^^^^^^^^
tests\test_hardcore_otb_bypass.py:36: in run_detectors
    decoded, stages, _ = try_decode_chain(text)
    ^^^^^^^^^^^^^^^^^^
E   ValueError: too many values to unpack (expected 3)
________________________ test_context_confusion_attack ________________________
tests\test_hardcore_otb_bypass.py:217: in test_context_confusion_attack
    hits = run_detectors(payload)
           ^^^^^^^^^^^^^^^^^^^^^^
tests\test_hardcore_otb_bypass.py:36: in run_detectors
    decoded, stages, _ = try_decode_chain(text)
    ^^^^^^^^^^^^^^^^^^
E   ValueError: too many values to unpack (expected 3)
___________________________ test_threshold_hunting ____________________________
tests\test_hardcore_otb_bypass.py:232: in test_threshold_hunting
    hits = run_detectors(payload)
           ^^^^^^^^^^^^^^^^^^^^^^
tests\test_hardcore_otb_bypass.py:36: in run_detectors
    decoded, stages, _ = try_decode_chain(text)
    ^^^^^^^^^^^^^^^^^^
E   ValueError: too many values to unpack (expected 3)
__________________________ test_bmv_hamming_boundary __________________________
tests\test_hardcore_otb_bypass.py:247: in test_bmv_hamming_boundary
    hits = run_detectors(payload)
           ^^^^^^^^^^^^^^^^^^^^^^
tests\test_hardcore_otb_bypass.py:36: in run_detectors
    decoded, stages, _ = try_decode_chain(text)
    ^^^^^^^^^^^^^^^^^^
E   ValueError: too many values to unpack (expected 3)
__________________________ test_k_of_n_single_family __________________________
tests_firewall\test_otb_gates.py:111: in test_k_of_n_single_family
    assert 'k_of_n_gate' in contrib
E   AssertionError: assert 'k_of_n_gate' in {'bidi_controls': {'base': 2.0, 'dampened': 2.0, 'strength': 'STRONG', 'context': 'natural'}, 'zero_width_chars': {'base': 1.3, 'dampened': 1.3, 'strength': 'MEDIUM', 'context': 'natural'}}
__________________ test_co_occurrence_gate_without_transport __________________
tests_firewall\test_p2_fpr_weights.py:25: in test_co_occurrence_gate_without_transport
    assert 'high_entropy_gate' in contrib or 'dense_alphabet_gate' in contrib
E   AssertionError: assert ('high_entropy_gate' in {'high_entropy_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'dense_alphabet_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'k_of_n_gate': 'Only 1 family/families active, require \u22652 for WARN/BLOCK (applied 0.5x penalty)'} or 'dense_alphabet_gate' in {'high_entropy_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'dense_alphabet_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'k_of_n_gate': 'Only 1 family/families active, require \u22652 for WARN/BLOCK (applied 0.5x penalty)'})
______________________ test_indicator_gate_code_context _______________________
tests_firewall\test_p2_fpr_weights.py:48: in test_indicator_gate_code_context
    assert 'indicator_gate' in contrib
E   AssertionError: assert 'indicator_gate' in {'bidi_controls': {'base': 2.0, 'dampened': 2.0, 'strength': 'STRONG', 'context': 'code'}}
________________________ test_decide_action_thresholds ________________________
tests_firewall\test_p2_fpr_weights.py:116: in test_decide_action_thresholds
    assert action == 'PASS'
E   AssertionError: assert 'WARN' == 'PASS'
E
E     - PASS
E     + WARN
__________________ test_transport_decode_indicators_complete __________________
tests_firewall\test_p2_fpr_weights.py:149: in test_transport_decode_indicators_complete
    assert TRANSPORT_DECODE_INDICATORS == expected
E   AssertionError: assert {'rfc2047', 'base64_multiline_detected', 'rfc2047_encoded', 'fullwidth_b64', 'base85', 'comment_split_b64', 'chain_decoded_3_stages', 'chain_decoded_1_stages', 'qp_multiline', 'armor_markers', 'any_armor', 'base64_secret', 'ascii85_detected', 'smime_ct', 'idna_punycode', 'pgp_armor', 'chain_decoded_2_stages'} == {'rfc2047', 'armor_markers', 'any_armor', 'base64_secret', 'smime_ct', 'base85', 'pgp_armor', 'chain_decoded_3_stages', 'chain_decoded_2_stages', 'chain_decoded_1_stages'}
E
E     Extra items in the left set:
E     'ascii85_detected'
E     'base64_multiline_detected'
E     'rfc2047_encoded'
E     'fullwidth_b64'
E     'idna_punycode'
E     'comment_split_b64'
E     'qp_multiline'
E
E     Full diff:
E       {
E           'any_armor',
E           'armor_markers',
E     +     'ascii85_detected',
E     +     'base64_multiline_detected',
E           'base64_secret',
E           'base85',
E           'chain_decoded_1_stages',
E           'chain_decoded_2_stages',
E           'chain_decoded_3_stages',
E     +     'comment_split_b64',
E     +     'fullwidth_b64',
E     +     'idna_punycode',
E           'pgp_armor',
E     +     'qp_multiline',
E           'rfc2047',
E     +     'rfc2047_encoded',
E           'smime_ct',
E       }
__________________________ test_weak_signals_reduced __________________________
tests_firewall\test_p2_fpr_weights.py:155: in test_weak_signals_reduced
    assert WEAK_SIGNALS['fullwidth_forms'] == 0.2  # Was 0.3 in V1
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'fullwidth_forms'
_________________ test_exotic_in_identifier_is_warn_or_block __________________
tests_firewall\test_p31_minis.py:88: in test_exotic_in_identifier_is_warn_or_block
    _test_action(text, ('WARN', 'BLOCK'))
tests_firewall\test_p31_minis.py:48: in _test_action
    assert action in expected_actions, \
E   AssertionError: Expected ('WARN', 'BLOCK'), got PASS (risk=0.60, hits=['unicode_math_alpha_seen'])
E   assert 'PASS' in ('WARN', 'BLOCK')
_____________________ test_mixed_script_identifier_blocks _____________________
tests_firewall\test_p31_minis.py:97: in test_mixed_script_identifier_blocks
    _test_action(text, ('WARN', 'BLOCK'))
tests_firewall\test_p31_minis.py:48: in _test_action
    assert action in expected_actions, \
E   AssertionError: Expected ('WARN', 'BLOCK'), got PASS (risk=0.00, hits=[])
E   assert 'PASS' in ('WARN', 'BLOCK')
__________________ test_entropy_without_transport_eliminated __________________
tests_firewall\test_two_key_enforcement.py:24: in test_entropy_without_transport_eliminated
    assert 'Two-Key Gate' in str(contrib), "Should have Two-Key Gate message"
E   AssertionError: Should have Two-Key Gate message
E   assert 'Two-Key Gate' in "{'high_entropy_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'dense_alphabet_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'indicator_gate': '<2 indicators in code (applied 0.5x penalty)', 'k_of_n_gate': 'Only 1 family/families active, require \u22652 for WARN/BLOCK (applied 0.5x penalty)'}"
E    +  where "{'high_entropy_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'dense_alphabet_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'indicator_gate': '<2 indicators in code (applied 0.5x penalty)', 'k_of_n_gate': 'Only 1 family/families active, require \u22652 for WARN/BLOCK (applied 0.5x penalty)'}" = str({'high_entropy_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'dense_alphabet_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'indicator_gate': '<2 indicators in code (applied 0.5x penalty)', 'k_of_n_gate': 'Only 1 family/families active, require \u22652 for WARN/BLOCK (applied 0.5x penalty)'})
_______________________ test_base64_split_with_comments _______________________
tests_firewall\test_ultra_break_v5_metamorph.py:188: in test_base64_split_with_comments
    _assert_blocked(payload, "Fragment: Base64 Commented")
tests_firewall\test_ultra_break_v5_metamorph.py:102: in _assert_blocked
    assert action in ('WARN', 'BLOCK'), f"BYPASS {desc}: {action} risk={risk:.2f} hits={hits}"
E   AssertionError: BYPASS Fragment: Base64 Commented: PASS risk=0.00 hits=['high_entropy', 'dense_alphabet']
E   assert 'PASS' in ('WARN', 'BLOCK')
============================== warnings summary ===============================
tests_firewall/test_final_boss_attack.py::test_final_boss_ultimate_obfuscation
  D:\MCP Mods\HAK_GAL_HEXAGONAL\standalone_packages\llm-security-firewall\src\llm_firewall\detectors\attack_patterns.py:14: DeprecationWarning: invalid escape sequence '\'
    text = text.encode('utf-8').decode('unicode_escape')

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/test_hardcore_otb_bypass.py::test_msg_stable_malicious - ValueError: too many values to unpack (expected 3)
FAILED tests/test_hardcore_otb_bypass.py::test_k_of_n_single_family_overload - ValueError: too many values to unpack (expected 3)
FAILED tests/test_hardcore_otb_bypass.py::test_executability_bypass_valid_code_hidden - ValueError: too many values to unpack (expected 3)
FAILED tests/test_hardcore_otb_bypass.py::test_co_occurrence_bypass_entropy_alone - ValueError: too many values to unpack (expected 3)
FAILED tests/test_hardcore_otb_bypass.py::test_indicator_gate_bypass_code_single - ValueError: too many values to unpack (expected 3)
FAILED tests/test_hardcore_otb_bypass.py::test_bmv_near_miss_attack - ValueError: too many values to unpack (expected 3)
FAILED tests/test_hardcore_otb_bypass.py::test_multi_gate_bypass_combo - ValueError: too many values to unpack (expected 3)
FAILED tests/test_hardcore_otb_bypass.py::test_msg_metamorphic_evasion - ValueError: too many values to unpack (expected 3)
FAILED tests/test_hardcore_otb_bypass.py::test_zero_family_stealth - ValueError: too many values to unpack (expected 3)
FAILED tests/test_hardcore_otb_bypass.py::test_context_confusion_attack - ValueError: too many values to unpack (expected 3)
FAILED tests/test_hardcore_otb_bypass.py::test_threshold_hunting - ValueError: too many values to unpack (expected 3)
FAILED tests/test_hardcore_otb_bypass.py::test_bmv_hamming_boundary - ValueError: too many values to unpack (expected 3)
FAILED tests_firewall/test_otb_gates.py::test_k_of_n_single_family - AssertionError: assert 'k_of_n_gate' in {'bidi_controls': {'base': 2.0, 'dampened': 2.0, 'strength': 'STRONG', 'context': 'natural'}, 'zero_width_chars': {'base': 1.3, 'dampened': 1.3, 'strength': 'MEDIUM', 'context': 'natural'}}
FAILED tests_firewall/test_p2_fpr_weights.py::test_co_occurrence_gate_without_transport - AssertionError: assert ('high_entropy_gate' in {'high_entropy_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'dense_alphabet_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'k_of_n_gate': 'Only 1 family/families active, require \u22652 for WARN/BLOCK (applied 0.5x penalty)'} or 'dense_alphabet_gate' in {'high_entropy_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'dense_alphabet_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'k_of_n_gate': 'Only 1 family/families active, require \u22652 for WARN/BLOCK (applied 0.5x penalty)'})
FAILED tests_firewall/test_p2_fpr_weights.py::test_indicator_gate_code_context - AssertionError: assert 'indicator_gate' in {'bidi_controls': {'base': 2.0, 'dampened': 2.0, 'strength': 'STRONG', 'context': 'code'}}
FAILED tests_firewall/test_p2_fpr_weights.py::test_decide_action_thresholds - AssertionError: assert 'WARN' == 'PASS'

  - PASS
  + WARN
FAILED tests_firewall/test_p2_fpr_weights.py::test_transport_decode_indicators_complete - AssertionError: assert {'rfc2047', 'base64_multiline_detected', 'rfc2047_encoded', 'fullwidth_b64', 'base85', 'comment_split_b64', 'chain_decoded_3_stages', 'chain_decoded_1_stages', 'qp_multiline', 'armor_markers', 'any_armor', 'base64_secret', 'ascii85_detected', 'smime_ct', 'idna_punycode', 'pgp_armor', 'chain_decoded_2_stages'} == {'rfc2047', 'armor_markers', 'any_armor', 'base64_secret', 'smime_ct', 'base85', 'pgp_armor', 'chain_decoded_3_stages', 'chain_decoded_2_stages', 'chain_decoded_1_stages'}

  Extra items in the left set:
  'ascii85_detected'
  'base64_multiline_detected'
  'rfc2047_encoded'
  'fullwidth_b64'
  'idna_punycode'
  'comment_split_b64'
  'qp_multiline'

  Full diff:
    {
        'any_armor',
        'armor_markers',
  +     'ascii85_detected',
  +     'base64_multiline_detected',
        'base64_secret',
        'base85',
        'chain_decoded_1_stages',
        'chain_decoded_2_stages',
        'chain_decoded_3_stages',
  +     'comment_split_b64',
  +     'fullwidth_b64',
  +     'idna_punycode',
        'pgp_armor',
  +     'qp_multiline',
        'rfc2047',
  +     'rfc2047_encoded',
        'smime_ct',
    }
FAILED tests_firewall/test_p2_fpr_weights.py::test_weak_signals_reduced - KeyError: 'fullwidth_forms'
FAILED tests_firewall/test_p31_minis.py::test_exotic_in_identifier_is_warn_or_block - AssertionError: Expected ('WARN', 'BLOCK'), got PASS (risk=0.60, hits=['unicode_math_alpha_seen'])
assert 'PASS' in ('WARN', 'BLOCK')
FAILED tests_firewall/test_p31_minis.py::test_mixed_script_identifier_blocks - AssertionError: Expected ('WARN', 'BLOCK'), got PASS (risk=0.00, hits=[])
assert 'PASS' in ('WARN', 'BLOCK')
FAILED tests_firewall/test_two_key_enforcement.py::test_entropy_without_transport_eliminated - AssertionError: Should have Two-Key Gate message
assert 'Two-Key Gate' in "{'high_entropy_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'dense_alphabet_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'indicator_gate': '<2 indicators in code (applied 0.5x penalty)', 'k_of_n_gate': 'Only 1 family/families active, require \u22652 for WARN/BLOCK (applied 0.5x penalty)'}"
 +  where "{'high_entropy_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'dense_alphabet_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'indicator_gate': '<2 indicators in code (applied 0.5x penalty)', 'k_of_n_gate': 'Only 1 family/families active, require \u22652 for WARN/BLOCK (applied 0.5x penalty)'}" = str({'high_entropy_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'dense_alphabet_suppressed': 'Tri-Key gate (no Transport/Unicode/STRONG)', 'indicator_gate': '<2 indicators in code (applied 0.5x penalty)', 'k_of_n_gate': 'Only 1 family/families active, require \u22652 for WARN/BLOCK (applied 0.5x penalty)'})
FAILED tests_firewall/test_ultra_break_v5_metamorph.py::test_base64_split_with_comments - AssertionError: BYPASS Fragment: Base64 Commented: PASS risk=0.00 hits=['high_entropy', 'dense_alphabet']
assert 'PASS' in ('WARN', 'BLOCK')
= 22 failed, 818 passed, 9 skipped, 1 xfailed, 3 xpassed, 1 warning in 60.32s (0:01:00) =
